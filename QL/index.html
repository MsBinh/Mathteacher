<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>üéì H·ªôi thi STEM & KHKT - THPT Tr·∫ßn Tr∆∞·ªùng Sinh</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: "Poppins", sans-serif;
    background: linear-gradient(135deg, #2b5876, #4e4376);
    color: #fff;
    min-height: 100vh;
    overflow-x: hidden;
  }
  .main-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 25px;
    padding: 40px;
    text-align: center;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.35);
    max-width: 860px;
    width: 95%;
    margin: 60px auto;
    backdrop-filter: blur(8px);
    transform: translateY(30px);
    animation: fadeInUp 1.2s ease forwards;
  }
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(50px); }
    to { opacity: 1; transform: translateY(0); }
  }
  h1 {
    font-weight: 700;
    font-size: 2.2rem;
    color: #ffdd57;
    text-shadow: 0 2px 6px rgba(0,0,0,0.3);
  }
  p.subtitle {
    font-size: 1.1rem;
    color: #f8f8f8;
    margin-bottom: 35px;
  }
  .btn-option {
    background: rgba(255, 255, 255, 0.12);
    border: 2px solid #fff;
    color: #fff;
    font-weight: 600;
    font-size: 1.1rem;
    padding: 14px 22px;
    border-radius: 14px;
    transition: all 0.3s ease;
    width: 100%;
  }
  .btn-option:hover {
    background: #ffdd57;
    color: #222;
    transform: translateY(-4px) scale(1.03);
    box-shadow: 0 8px 25px rgba(255, 255, 255, 0.4);
  }
  .footer {
    margin-top: 40px;
    font-size: 0.9rem;
    color: #ddd;
  }
  .badge {
    font-size: 0.9rem;
  }
  /* floating animation */
  .float {
    animation: float 6s ease-in-out infinite;
  }
  @keyframes float {
    0% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
    100% { transform: translateY(0); }
  }
  .admin-area {
    display: none;
    margin-top: 25px;
  }
</style>
</head>
<body>
  <div class="container">
    <div class="main-card mx-auto">
      <img src="https://cdn-icons-png.flaticon.com/512/906/906175.png" width="90" class="mb-3 float" alt="STEM Logo">
      <h1>H·ªòI THI STEM & KHKT</h1>
      <p class="subtitle">Tr∆∞·ªùng THPT Tr·∫ßn Tr∆∞·ªùng Sinh - S·ªü GD&ƒêT Vƒ©nh Long</p>

      <div class="row g-3 mb-3">
        <div class="col-md-6">
          <a href="STEM.html" class="btn btn-option">
            üî¨ CH·∫§M S·∫¢N PH·∫®M STEM<br><span class="badge bg-light text-dark mt-2">D√†nh cho Gi√°m kh·∫£o STEM</span>
          </a>
        </div>
        <div class="col-md-6">
          <a href="KHKT.html" class="btn btn-option">
            üß™ CH·∫§M D·ª∞ √ÅN KHKT<br><span class="badge bg-light text-dark mt-2">D√†nh cho Gi√°m kh·∫£o KHKT</span>
          </a>
        </div>
      </div>

      <hr class="my-4 text-light" style="opacity:0.3;">

      <!-- ADMIN BUTTON -->
      <button id="admin-login-btn" class="btn btn-warning btn-lg px-4">üèÜ KHU V·ª∞C ADMIN</button>

      <div class="admin-area" id="admin-area">
        <div class="mt-4">
          <a href="KQ.html" class="btn btn-success btn-option mb-3">üìä T·ªïng h·ª£p & C√¥ng b·ªë k·∫øt qu·∫£</a>
          <a href="EDITKQ.html" class="btn btn-danger btn-option">üóëÔ∏è X√≥a d·ªØ li·ªáu ch·∫•m ƒëi·ªÉm th·ª≠ </a>
        </div>
      </div>

      <div class="footer mt-4">
        ¬© 2025 THPT Tr·∫ßn Tr∆∞·ªùng Sinh | Thi·∫øt k·∫ø b·ªüi nguyenthanhbinh.edu.vn üåê  
      </div>
    </div>
  </div>

  <!-- Modal ƒëƒÉng nh·∫≠p Admin -->
  <div id="login-modal" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:9999;">
    <div style="background:#fff;color:#000;padding:20px;border-radius:10px;width:320px;">
      <h5 class="mb-3">ƒêƒÉng nh·∫≠p ADMIN</h5>
      <form id="code-login-form">
        <input id="login-code" placeholder="M√£ ADMIN" required style="width:100%;padding:8px;margin:6px 0;" type="text">
        <input id="admin-name" placeholder="H·ªç t√™n" required style="width:100%;padding:8px;margin:6px 0;" type="text">
        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
          <button type="submit" class="btn btn-primary btn-sm">ƒêƒÉng nh·∫≠p</button>
          <button type="button" class="btn btn-secondary btn-sm" id="close-login">ƒê√≥ng</button>
        </div>
      </form>
      <div id="auth-status" class="mt-2 text-center text-dark fw-semibold"></div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getFirestore, collection, query, where, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDDACFZgZazMOnjzmGM_lrKswVcsoTFHxA",
      authDomain: "veonline-3bcbf.firebaseapp.com",
      projectId: "veonline-3bcbf",
      storageBucket: "veonline-3bcbf.appspot.com",
      messagingSenderId: "83902304195",
      appId: "1:83902304195:web:2f9ec1ee0c23d6e21bb776"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const ADMIN_CODE = "yennhi2008";

    const modal = document.getElementById("login-modal");
    const adminArea = document.getElementById("admin-area");
    const adminLoginBtn = document.getElementById("admin-login-btn");

    adminLoginBtn.onclick = () => modal.style.display = "flex";
    document.getElementById("close-login").onclick = () => modal.style.display = "none";

    document.getElementById("code-login-form").addEventListener("submit", async (e) => {
      e.preventDefault();
      const code = document.getElementById("login-code").value.trim();
      const name = document.getElementById("admin-name").value.trim();
      const status = document.getElementById("auth-status");
      status.textContent = "üîÑ ƒêang x√°c th·ª±c...";

      try {
        const q = query(collection(db, "codes"), where("code", "==", code));
        const snap = await getDocs(q);
        if (!snap.empty || code === ADMIN_CODE) {
          localStorage.setItem("judgeCode", code);
          localStorage.setItem("judgeName", name);
          status.textContent = "‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng!";
          modal.style.display = "none";
          adminArea.style.display = "block";
        } else {
          status.textContent = "‚ùå M√£ kh√¥ng h·ª£p l·ªá!";
        }
      } catch (err) {
        status.textContent = "‚ö†Ô∏è L·ªói: " + err.message;
      }
    });

    // X√ìA DEMO
    document.getElementById("btn-clear-demo").addEventListener("click", async () => {
      if (!confirm("‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ d·ªØ li·ªáu ch·∫•m ƒëi·ªÉm th·ª≠ (demo)?")) return;
      try {
        const q = query(collection(db, "scores"));
        const snap = await getDocs(q);
        let count = 0;
        for (const d of snap.docs) {
          if (d.id.startsWith("demo") || d.data().judgeCode?.includes("TEST")) {
            await deleteDoc(doc(db, "scores", d.id));
            count++;
          }
        }
        alert(`‚úÖ ƒê√£ x√≥a ${count} b·∫£n ghi demo.`);
      } catch (err) {
        alert("‚ùå L·ªói khi x√≥a: " + err.message);
      }
    });
  </script>
</body>
</html>
