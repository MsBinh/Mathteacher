<!DOCTYPE html>

<html lang="vi">
<head>
<meta charset="utf-8"/>
<title> L·ªöP TO√ÅN TH·∫¶Y B√åNH </title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<!-- Reveal.js CSS -->
<link href="https://unpkg.com/reveal.js/dist/reveal.css" rel="stylesheet"/>
<link href="https://unpkg.com/reveal.js/dist/theme/black.css" id="theme" rel="stylesheet"/>
<!-- Th√™m v√†o ph·∫ßn head, sau c√°c link CSS hi·ªán c√≥ -->
<script src="https://unpkg.com/reveal.js/dist/reveal.js"></script>
<script src="https://unpkg.com/reveal.js/plugin/notes/notes.js"></script>
<script src="https://unpkg.com/reveal.js/plugin/markdown/markdown.js"></script>
<script src="https://unpkg.com/reveal.js/plugin/highlight/highlight.js"></script>
<script src="https://unpkg.com/reveal.js/plugin/math/math.js"></script>
<link href="https://unpkg.com/reveal.js/plugin/highlight/monokai.css" rel="stylesheet"/>
<!-- MathJax -->
<script>
    MathJax = {
      tex: { 
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']]
      },
      svg: { fontCache: 'global', linebreaks: { automatic: true } },
      chtml: { linebreaks: { automatic: true } }
    };
  </script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<link rel="stylesheet" href="styless.css">
<!-- ===== style chuy√™n ƒë·ªÅ  ===== -->
</head>
<body>
<!-- ===== Thanh ti√™u ƒë·ªÅ c·ªë ƒë·ªãnh ===== -->
<div class="topbar">
<div class="topbar-title">L·ªöP TO√ÅN TH·∫¶Y B√åNH</div>
<div class="clock" id="clock">--:--:--</div>
<button id="toggleMenu">‚ò∞</button>
<!-- ==== Thanh c√¥ng c·ª•: Ch·ªçn ƒë·ªÅ / ƒêƒÉng nh·∫≠p / T√≠nh ƒëi·ªÉm ==== -->
<div class="topbar-controls">
  
<select id="selectExam">
<option value="">-- Ch·ªçn ƒë·ªÅ --</option>
<option value="de1">ƒê·ªÅ 1</option>
<option value="de2">ƒê·ªÅ 2</option>
</select>
<button id="loginBtn">üîë ƒêƒÉng nh·∫≠p</button>
<button id="scoreBtn">üìä T√≠nh ƒëi·ªÉm</button>
</div>

</div>
<div class="reveal">
<div class="slides">
<!-------------B·∫ÆT ƒê·∫¶U N·ªòI DUNG C√ÅC SLIDE-->
<!-- T√äN B√ÄI -->
<section>
<h2>üìò ƒê·ªÄ KI·ªÇM TRA</h2>
<p>M√¥n To√°n - L·ªõp 10</p>
</section>
<section>
<h2>üìò H·ªÜ TH·ª®C L∆Ø·ª¢NG ƒê·ªÄ 1 </h2>
</section>
<!--@@@@-->
<section>
                <section>
                    <div class="question" id="q1">
                        <p class="question-title"><strong>C√¢u 1.</strong> <strong>C√¢u 1:</strong> H√¨nh b√¨nh h√†nh c√≥ m·ªôt c·∫°nh l√† 4 hai ƒë∆∞·ªùng ch√©o l√† 6 v√† 8. T√≠nh ƒë·ªô d√†i c·∫°nh k·ªÅ v·ªõi c·∫°nh c√≥ ƒë·ªô d√†i b·∫±ng 4</p>
                       
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q1" value="A"/><span class="option-letter">A.</span><span class="option-text">\(\sqrt{34}\)</span><span class="icon" id="icon-q1-A"></span></label>
        <label class="option-label"><input type="radio" name="q1" value="B"/><span class="option-letter">B.</span><span class="option-text">6.</span><span class="icon" id="icon-q1-B"></span></label>
        <label class="option-label"><input type="radio" name="q1" value="C"/><span class="option-letter">C.</span><span class="option-text">\(\sqrt{42}\).</span><span class="icon" id="icon-q1-C"></span></label>
        <label class="option-label"><input type="radio" name="q1" value="D"/><span class="option-letter">D.</span><span class="option-text">5.</span><span class="icon" id="icon-q1-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q1','A')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
               
            </section>
            <section>
                <section>
                    <div class="question" id="q2">
                        <p class="question-title"><strong>C√¢u 2.</strong> <strong>C√¢u 2:</strong> Tam gi√°c ABC c√≥ \(BC = \sqrt{5}\), \(AC = 3\) v√† \(\cot C = -2\). T√≠nh c·∫°nh AB</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q2" value="A"/><span class="option-letter">A.</span><span class="option-text">\(2\sqrt{10}\).</span><span class="icon" id="icon-q2-A"></span></label>
        <label class="option-label"><input type="radio" name="q2" value="B"/><span class="option-letter">B.</span><span class="option-text">\(\sqrt{26}\).</span><span class="icon" id="icon-q2-B"></span></label>
        <label class="option-label"><input type="radio" name="q2" value="C"/><span class="option-letter">C.</span><span class="option-text">\(\sqrt{21}\).</span><span class="icon" id="icon-q2-C"></span></label>
        <label class="option-label"><input type="radio" name="q2" value="D"/><span class="option-letter">D.</span><span class="option-text">\(\frac{9}{\sqrt{5}}\)</span><span class="icon" id="icon-q2-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q2','C')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q3">
                        <p class="question-title"><strong>C√¢u 3.</strong> <strong>C√¢u 3:</strong> T√≠nh b√°n k√≠nh ƒë∆∞·ªùng tr√≤n ngo·∫°i ti·∫øp tam gi√°c ABC bi·∫øt AB = 10 v√† \(\tan(A+B) = -\frac{1}{3}\).</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q3" value="A"/><span class="option-letter">A.</span><span class="option-text">\(\frac{5\sqrt{10}}{9}\)</span><span class="icon" id="icon-q3-A"></span></label>
        <label class="option-label"><input type="radio" name="q3" value="B"/><span class="option-letter">B.</span><span class="option-text">\(\frac{10}{3}\)</span><span class="icon" id="icon-q3-B"></span></label>
        <label class="option-label"><input type="radio" name="q3" value="C"/><span class="option-letter">C.</span><span class="option-text">\(\frac{\sqrt{10}}{5}\)</span><span class="icon" id="icon-q3-C"></span></label>
        <label class="option-label"><input type="radio" name="q3" value="D"/><span class="option-letter">D.</span><span class="option-text">\(5\sqrt{10}\).</span><span class="icon" id="icon-q3-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q3','D')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q4">
                        <p class="question-title"><strong>C√¢u 4.</strong> <strong>C√¢u 4:</strong> T√≠nh b√°n k√≠nh ƒë∆∞·ªùng tr√≤n ngo·∫°i ti·∫øp tam gi√°c ABC bi·∫øt AB =12 v√† \(\cot(A+B) = \frac{1}{3}\).</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q4" value="A"/><span class="option-letter">A.</span><span class="option-text">\(2\sqrt{10}\).</span><span class="icon" id="icon-q4-A"></span></label>
        <label class="option-label"><input type="radio" name="q4" value="B"/><span class="option-letter">B.</span><span class="option-text">\(\frac{9\sqrt{10}}{5}\)</span><span class="icon" id="icon-q4-B"></span></label>
        <label class="option-label"><input type="radio" name="q4" value="C"/><span class="option-letter">C.</span><span class="option-text">\(5\sqrt{10}\).</span><span class="icon" id="icon-q4-C"></span></label>
        <label class="option-label"><input type="radio" name="q4" value="D"/><span class="option-letter">D.</span><span class="option-text">\(3\sqrt{2}\).</span><span class="icon" id="icon-q4-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q4','A')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
               
            </section>
            <section>
                <section>
                    <div class="question" id="q5">
                        <p class="question-title"><strong>C√¢u 5.</strong> <strong>C√¢u 5:</strong> T√¨m chu vi tam gi√°c ABC, bi·∫øt r·∫±ng AB = 6 v√† \(2 \sin A = 3 \sin B = 4 \sin C\).</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q5" value="A"/><span class="option-letter">A.</span><span class="option-text">26</span><span class="icon" id="icon-q5-A"></span></label>
        <label class="option-label"><input type="radio" name="q5" value="B"/><span class="option-letter">B.</span><span class="option-text">13.</span><span class="icon" id="icon-q5-B"></span></label>
        <label class="option-label"><input type="radio" name="q5" value="C"/><span class="option-letter">C.</span><span class="option-text">\(5\sqrt{26}\).</span><span class="icon" id="icon-q5-C"></span></label>
        <label class="option-label"><input type="radio" name="q5" value="D"/><span class="option-letter">D.</span><span class="option-text">\(10\sqrt{6}\).</span><span class="icon" id="icon-q5-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q5','A')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q6">
                        <p class="question-title"><strong>C√¢u 6.</strong> <strong>C√¢u 6:</strong> Cho tam gi√°c ABC c√≥ \(AB = AC = 2BC = a\). Bi·∫øt \(R.r = \frac{1}{2}\) v·ªõi R,r l·∫ßn l∆∞·ª£t l√† b√°n k√≠nh ƒë∆∞·ªùng tr√≤n ngo·∫°i ti·∫øp v√† n·ªôi ti·∫øp tam gi√°c ABC. T√≠nh a.</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q6" value="A"/><span class="option-letter">A.</span><span class="option-text">\(a = 2\).</span><span class="icon" id="icon-q6-A"></span></label>
        <label class="option-label"><input type="radio" name="q6" value="B"/><span class="option-letter">B.</span><span class="option-text">\(a = \sqrt{2}\).</span><span class="icon" id="icon-q6-B"></span></label>
        <label class="option-label"><input type="radio" name="q6" value="C"/><span class="option-letter">C.</span><span class="option-text">\(a = \sqrt{5}\)</span><span class="icon" id="icon-q6-C"></span></label>
        <label class="option-label"><input type="radio" name="q6" value="D"/><span class="option-letter">D.</span><span class="option-text">\(a = \sqrt{3}\).</span><span class="icon" id="icon-q6-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q6','C')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q7">
                        <p class="question-title"><strong>C√¢u 7.</strong> <strong>C√¢u 7:</strong> Cho tam gi√°c ABC bi·∫øt ƒë·ªô d√†i ba c·∫°nh BC, CA, AB l·∫ßn l∆∞·ª£t l√† a, b, c v√† th·ªèa m√£n h·ªá th·ª©c \(b(b^2 -a^2) = c(c^2 - a^2)\) v·ªõi \(b\ne c\). Khi ƒë√≥, g√≥c BAC b·∫±ng</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q7" value="A"/><span class="option-letter">A.</span><span class="option-text">\(45^\circ\).</span><span class="icon" id="icon-q7-A"></span></label>
        <label class="option-label"><input type="radio" name="q7" value="B"/><span class="option-letter">B.</span><span class="option-text">\(60^\circ\).</span><span class="icon" id="icon-q7-B"></span></label>
        <label class="option-label"><input type="radio" name="q7" value="C"/><span class="option-letter">C.</span><span class="option-text">\(90^\circ\).</span><span class="icon" id="icon-q7-C"></span></label>
        <label class="option-label"><input type="radio" name="q7" value="D"/><span class="option-letter">D.</span><span class="option-text">\(120^\circ\)</span><span class="icon" id="icon-q7-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q7','D')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
               
            </section>
            <section>
                <section>
                    <div class="question" id="q8">
                        <p class="question-title"><strong>C√¢u 8.</strong> <strong>C√¢u 8:</strong> Tam gi√°c ABC c√≥ t·ªïng hai g√≥c B v√† C b·∫±ng \(135^\circ\) v√† ƒë·ªô d√†i c·∫°nh BC b·∫±ng \(a\). T√≠nh b√°n k√≠nh ƒë∆∞·ªùng tr√≤n ngo·∫°i ti·∫øp tam gi√°c.</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q8" value="A"/><span class="option-letter">A.</span><span class="option-text">\(a\sqrt{3}\).</span><span class="icon" id="icon-q8-A"></span></label>
        <label class="option-label"><input type="radio" name="q8" value="B"/><span class="option-letter">B.</span><span class="option-text">\(a\sqrt{2}\).</span><span class="icon" id="icon-q8-B"></span></label>
        <label class="option-label"><input type="radio" name="q8" value="C"/><span class="option-letter">C.</span><span class="option-text">\(\frac{a\sqrt{3}}{2}\)</span><span class="icon" id="icon-q8-C"></span></label>
        <label class="option-label"><input type="radio" name="q8" value="D"/><span class="option-letter">D.</span><span class="option-text">\(\frac{a\sqrt{2}}{2}\)</span><span class="icon" id="icon-q8-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q8','D')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q9">
                        <p class="question-title"><strong>C√¢u 9.</strong> <strong>C√¢u 9:</strong> Tam gi√°c ABC c√≥ \(\hat{A}=105^\circ\), \(\hat{B}=45^\circ\), AC=10. T√≠nh c·∫°nh AB.</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q9" value="A"/><span class="option-letter">A.</span><span class="option-text">\(5\sqrt{6}\).</span><span class="icon" id="icon-q9-A"></span></label>
        <label class="option-label"><input type="radio" name="q9" value="B"/><span class="option-letter">B.</span><span class="option-text">\(\frac{5\sqrt{6}}{2}\)</span><span class="icon" id="icon-q9-B"></span></label>
        <label class="option-label"><input type="radio" name="q9" value="C"/><span class="option-letter">C.</span><span class="option-text">\(5\sqrt{2}\).</span><span class="icon" id="icon-q9-C"></span></label>
        <label class="option-label"><input type="radio" name="q9" value="D"/><span class="option-letter">D.</span><span class="option-text">\(10\sqrt{2}\)</span><span class="icon" id="icon-q9-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q9','C')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q10">
                        <p class="question-title"><strong>C√¢u 10.</strong> <strong>C√¢u 10:</strong> Cho tam gi√°c ABC n·ªôi ti·∫øp ƒë∆∞·ªùng tr√≤n b√°n k√≠nh R, AB = R, \(AC = R\sqrt{2}\). T√≠nh g√≥c A bi·∫øt \(\hat{A}\) l√† g√≥c t√π.</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q10" value="A"/><span class="option-letter">A.</span><span class="option-text">\(120^\circ\).</span><span class="icon" id="icon-q10-A"></span></label>
        <label class="option-label"><input type="radio" name="q10" value="B"/><span class="option-letter">B.</span><span class="option-text">\(150^\circ\).</span><span class="icon" id="icon-q10-B"></span></label>
        <label class="option-label"><input type="radio" name="q10" value="C"/><span class="option-letter">C.</span><span class="option-text">\(135^\circ\).</span><span class="icon" id="icon-q10-C"></span></label>
        <label class="option-label"><input type="radio" name="q10" value="D"/><span class="option-letter">D.</span><span class="option-text">\(105^\circ\).</span><span class="icon" id="icon-q10-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q10','D')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q11">
                        <p class="question-title"><strong>C√¢u 11.</strong> <strong>C√¢u 11:</strong> Tam gi√°c ABC c√≥ AB=16cm, BC = 20cm v√† di·ªán t√≠ch l√† \(80cm^2\). T√≠nh s·ªë ƒëo g√≥c B c·ªßa tam gi√°c ABC.</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q11" value="A"/><span class="option-letter">A.</span><span class="option-text">\(45^\circ\).</span><span class="icon" id="icon-q11-A"></span></label>
        <label class="option-label"><input type="radio" name="q11" value="B"/><span class="option-letter">B.</span><span class="option-text">\(30^\circ\).</span><span class="icon" id="icon-q11-B"></span></label>
        <label class="option-label"><input type="radio" name="q11" value="C"/><span class="option-letter">C.</span><span class="option-text">\(60^\circ\).</span><span class="icon" id="icon-q11-C"></span></label>
        <label class="option-label"><input type="radio" name="q11" value="D"/><span class="option-letter">D.</span><span class="option-text">\(75^\circ\).</span><span class="icon" id="icon-q11-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q11','B')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q12">
                        <p class="question-title"><strong>C√¢u 12.</strong> <strong>C√¢u 12:</strong> Cho tam gi√°c ABC vu√¥ng c√¢n t·∫°i A v√† \(AB = a\sqrt{2}\). T√≠nh b√°n k√≠nh ƒë∆∞·ªùng tr√≤n n·ªôi ti·∫øp tam gi√°c ABC.</p>
                        
                        <div class="options-row">
        <label class="option-label"><input type="radio" name="q12" value="A"/><span class="option-letter">A.</span><span class="option-text">\(a\).</span><span class="icon" id="icon-q12-A"></span></label>
        <label class="option-label"><input type="radio" name="q12" value="B"/><span class="option-letter">B.</span><span class="option-text">\(\frac{\sqrt{2}}{2}a\).</span><span class="icon" id="icon-q12-B"></span></label>
        <label class="option-label"><input type="radio" name="q12" value="C"/><span class="option-letter">C.</span><span class="option-text">\((\sqrt{2}-1)a\).</span><span class="icon" id="icon-q12-C"></span></label>
        <label class="option-label"><input type="radio" name="q12" value="D"/><span class="option-letter">D.</span><span class="option-text">\(\frac{1}{2}a\).</span><span class="icon" id="icon-q12-D"></span></label>
                        </div>
                        <div class="answer-check">
                            <button class="check-btn" onclick="checkAnswer('q12','C')">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q13">
                        <p class="question-title"><strong>C√¢u 13.</strong> <strong>C√¢u 1:</strong> Cho tam gi√°c ABC c√≥ AB = 3, AC = 2, \(\hat{A} = 60^\circ\). Tr√™n c·∫°nh BC l·∫•y ƒëi·ªÉm M n·∫±m gi·ªØa B v√† C</p>
                        
                        <div class="options">
        <div class="option-row">a) \(BC^2 = AB^2 + AC^2 +2AB.AC.\cos A\).
          <label><input name="q13a" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q13a" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">b) \(BC = \sqrt{7}\).
          <label><input name="q13b" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q13b" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">c) \(\cos B = \frac{\sqrt{7}}{7}\)
          <label><input name="q13c" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q13c" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">d) ƒê·ªô d√†i AM nh·ªè nh·∫•t b·∫±ng \(\frac{189}{49}\)
          <label><input name="q13d" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q13d" type="radio" value='False'/> Sai</label>
        </div>
                        </div>
                        <div class="answer-check">
                            <button onclick="checkTrueFalseAnswer('q13',['False','True','False','False'])">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q14">
                        <p class="question-title"><strong>C√¢u 14.</strong> <strong>C√¢u 2:</strong> Cho tam gi√°c ABC c√≥ \(AC =b=7\); \(AB = c =5\); \(\cos A = \frac{3}{5}\).</p>
                        
                        <div class="options">
        <div class="option-row">a) g√≥c A l√† g√≥c t√π.
          <label><input name="q14a" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q14a" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">b) \(a = 4\sqrt{2}\).
          <label><input name="q14b" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q14b" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">c) \(\sin A = -\frac{4}{5}\)
          <label><input name="q14c" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q14c" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">d) ƒê·ªô d√†i ƒë∆∞·ªùng cao h·∫° t·ª´ ƒë·ªânh A b·∫±ng \(\frac{7\sqrt{2}}{2}\)
          <label><input name="q14d" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q14d" type="radio" value='False'/> Sai</label>
        </div>
                        </div>
                        <div class="answer-check">
                            <button onclick="checkTrueFalseAnswer('q14',['False','True','False','True'])">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q15">
                        <p class="question-title"><strong>C√¢u 15.</strong> <strong>C√¢u 3:</strong> Cho tam gi√°c ABC c√≥ AB = 2; AC = 3; BC = 4 .</p>
                       
                        <div class="options">
        <div class="option-row">a) Di·ªán t√≠ch c·ªßa tam gi√°c ABC l√† \(S_{ABC} = \frac{3\sqrt{15}}{4}\)
          <label><input name="q15a" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q15a" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">b) B√°n k√≠nh ƒë∆∞·ªùng tr√≤n n·ªôi ti·∫øp c·ªßa tam gi√°c ABC l√† \(r = \frac{\sqrt{15}}{5}\)
          <label><input name="q15b" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q15b" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">c) G·ªçi M, N l·∫ßn l∆∞·ª£t l√† trung ƒëi·ªÉm c·ªßa c·∫°nh AC v√† AB. Khi ƒë√≥, \(S_{ANC} < S_{AMB}\)
          <label><input name="q15c" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q15c" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">d) G·ªçi D l√† ƒëi·ªÉm ƒë·ªëi x·ª©ng c·ªßa N qua B. Khi ƒë√≥, \(\cos NCD = \frac{2\sqrt{115}}{23}\)
          <label><input name="q15d" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q15d" type="radio" value='False'/> Sai</label>
        </div>
                        </div>
                        <div class="answer-check">
                            <button onclick="checkTrueFalseAnswer('q15',['True','False','False','True'])">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q16">
                        <p class="question-title"><strong>C√¢u 16.</strong> <strong>C√¢u 4:</strong> Cho tam gi√°c ABC c√¢n t·∫°i A c√≥ \(\hat{C}=30^\circ\), BC = 3 cm .</p>
                        
                        <div class="options">
        <div class="option-row">a) B√°n k√≠nh ƒë∆∞·ªùng tr√≤n ngo·∫°i ti·∫øp c·ªßa tam gi√°c ABC l√† \(R = \sqrt{3}\) .
          <label><input name="q16a" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q16a" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">b) Di·ªán t√≠ch tam gi√°c ABC l√† \(\frac{\sqrt{3}}{4}\) (\(cm^2\))
          <label><input name="q16b" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q16b" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">c) MB \(\perp\) NC ·ªü ƒë√≥ M, N l√† trung ƒëi·ªÉm c·ªßa AC v√† AB.
          <label><input name="q16c" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q16c" type="radio" value='False'/> Sai</label>
        </div>
        <div class="option-row">d) Tr√™n tia ƒë·ªëi c·ªßa tia AC ta l·∫•y D sao cho \(BD = \frac{3\sqrt{2}}{2}\) cm. Khi ƒë√≥ \(\cos \widehat{ABD} = \frac{\sqrt{6}-\sqrt{2}}{4}\).
          <label><input name="q16d" type="radio" value='True'/> ƒê√∫ng</label>
          <label><input name="q16d" type="radio" value='False'/> Sai</label>
        </div>
                        </div>
                        <div class="answer-check">
                            <button onclick="checkTrueFalseAnswer('q16',['True','False','False','True'])">Ki·ªÉm tra</button>
                        </div>
                    </div>
                </section>
                
            </section>
            <section>
                <section>
                    <div class="question" id="q17">
                        <p class="question-title"><strong>C√¢u 17.</strong> <strong>C√¢u 1:</strong> Tam gi√°c ABC c√≥ BC = 12, CA = 9, AB = 6. Tr√™n c·∫°nh BC l·∫•y ƒëi·ªÉm M sao cho BM = 4. T√≠nh ƒë·ªô d√†i ƒëo·∫°n th·∫≥ng AM . (k·∫øt qu·∫£ l√†m tr√≤n ƒë·∫øn h√†ng ph·∫ßn trƒÉm)</p>
                        
                        <div class="answer-check">
                            <input type="text" id="input-q17" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi">
                            <button onclick="checkShortAnswer('q17','4,36')">Ki·ªÉm tra</button>
                            <span id="icon-q17"></span>
                        </div>
                    </div>
                </section>
               
            </section>
            <section>
                <section>
                    <div class="question" id="q18">
                        <p class="question-title"><strong>C√¢u 18.</strong> <strong>C√¢u 2:</strong> Cho \(\triangle ABC\) c√≥ AB = 2 ; AC = 3 ; A = 60¬∞. T√≠nh ƒë·ªô d√†i ƒë∆∞·ªùng ph√¢n gi√°c trong g√≥c A c·ªßa tam gi√°c ABC. (k·∫øt qu·∫£ l√†m tr√≤n ƒë·∫øn h√†ng ph·∫ßn trƒÉm)</p>
                        
                        <div class="answer-check">
                            <input type="text" id="input-q18" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi">
                            <button onclick="checkShortAnswer('q18','2,08')">Ki·ªÉm tra</button>
                            <span id="icon-q18"></span>
                        </div>
                    </div>
                </section>
                
            </section>

             <section>
                
                
            </section>

            <section>
                <section>
                    
                        <div class="question-title"><strong>C√¢u 19.</strong> <strong>C√¢u 3:</strong> Hai chi·∫øc t√†u thu·ª∑ c√πng xu·∫•t ph√°t t·ª´ v·ªã tr√≠ A, ƒëi th·∫≥ng theo hai h∆∞·ªõng t·∫°o v·ªõi nhau m·ªôt g√≥c \(60^\circ\). T√†u th·ª© nh·∫•t ch·∫°y v·ªõi t·ªëc ƒë·ªô 30km/h, t√†u th·ª© hai ch·∫°y v·ªõi t·ªëc ƒë·ªô 40km/h. H·ªèi sau 2 gi·ªù hai t√†u c√°ch nhau bao nhi√™u km? (k·∫øt qu·∫£ l√†m tr√≤n ƒë·∫øn h√†ng ƒë∆°n v·ªã).</p>
                        
                        <div class="answer-check">
                            <input type="text" id="input-q19" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi">
                            <button onclick="checkShortAnswer('q19','72')">Ki·ªÉm tra</button>
                            <span id="icon-q19"></span>
                        </div>
                    </div>
                </section>
                </section>
                <section>
                    <div class="question" id="q20">
                        <p class="question-title"><strong>C√¢u 20.</strong> <strong>C√¢u 4:</strong> T·ª´ hai v·ªã tr√≠ A v√† B c·ªßa m·ªôt t√≤a nh√†, ng∆∞·ªùi ta quan s√°t ƒë·ªânh C c·ªßa ng·ªçn n√∫i. Bi·∫øt r·∫±ng ƒë·ªô cao AB = 70m, ph∆∞∆°ng nh√¨n AC t·∫°o v·ªõi ph∆∞∆°ng n·∫±m ngang g√≥c \(30^\circ\), ph∆∞∆°ng nh√¨n BC t·∫°o v·ªõi ph∆∞∆°ng n·∫±m ngang g√≥c \(15^\circ30'\). Ng·ªçn n√∫i ƒë√≥ c√≥ ƒë·ªô cao so v·ªõi m·∫∑t ƒë·∫•t? (k·∫øt qu·∫£ l√†m tr√≤n ƒë·∫øn h√†ng ƒë∆°n v·ªã).</p>
                        <img src="data/im/htld1-c20.png">
                        <div class="answer-check">
                            <input type="text" id="input-q20" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi">
                            <button onclick="checkShortAnswer('q20','135')">Ki·ªÉm tra</button>
                            <span id="icon-q20"></span>
                        </div>
                    </div>
                </section>
           
            <section>
                <section>
                    <div class="question" id="q21">
                        <p class="question-title"><strong>C√¢u 21.</strong> <strong>C√¢u 5:</strong> Cho h√¨nh ch·ªØ nh·∫≠t ABCD c√≥ AB = 8, AD = 6. G·ªçi P l√† trung ƒëi·ªÉm c·∫°nh CD v√† Q l√† ƒëi·ªÉm thu·ªôc c·∫°nh BC sao cho \(QC = 2QB\). T√≠nh b√°n k√≠nh ƒë∆∞·ªùng tr√≤n ngo·∫°i ti·∫øp tam gi√°c APQ. (k·∫øt qu·∫£ l√†m tr√≤n ƒë·∫øn h√†ng ph·∫ßn m∆∞·ªùi)</p>
                        
                        <div class="answer-check">
                            <input type="text" id="input-q21" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi">
                            <button onclick="checkShortAnswer('q21','4,2')">Ki·ªÉm tra</button>
                            <span id="icon-q21"></span>
                        </div>
                    </div>
                </section>
                
            </section>

            <section>
                <section>
                    <div class="question" id="q22">
                        <p class="question-title"><strong>C√¢u 22.</strong>  M·ªôt b√°c n√¥ng d√¢n c√≥ m·∫£nh v∆∞·ªùn h√¨nh t·ª© gi√°c c√≥ m·ªôt g√≥c vu√¥ng v·ªõi k√≠ch th∆∞·ªõc 4 c·∫°nh l√† 35m,45m,52m,20m (nh∆∞ h√¨nh v·∫Ω). H√£y t√≠nh di·ªán t√≠ch c·ªßa m·∫£nh v∆∞·ªùn ƒë√≥ (k·∫øt qu·∫£ l√†m tr√≤n ƒë·∫øn h√†ng ƒë∆°n v·ªã).</p>
                        <img src="data/im/htld1-c22.png">
                        <div class="answer-check">
                            <input type="text" id="input-q22" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi">
                            <button onclick="checkShortAnswer('q22','1306')">Ki·ªÉm tra</button>
                            <span id="icon-q22"></span>
                        </div>
                    </div>
                </section>
                </section>
<!---------------------------------------------------------THE END----------------------------------------------------->
</div>
</div>
<!-- Slide Navigation Menu -->
<div class="slide-menu" id="slideMenu">
<div class="menu-header">
<h3>üìã Danh s√°ch slide</h3>
<button class="close-btn" onclick="closeSlideMenu()">√ó</button>
</div>
<div class="menu-content">
<div class="slide-list" id="slideList">
<!-- Danh s√°ch slide s·∫Ω ƒë∆∞·ª£c t·∫°o t·ª± ƒë·ªông b·∫±ng JavaScript -->
</div>
</div>
</div>
<!-- N√∫t m·ªü menu -->
<button class="menu-toggle" id="menuToggle" onclick="toggleSlideMenu()">üìã</button>
<!-- Canvas -->

<!-- ==== Canvas + Toolbar ==== -->
<canvas id="drawCanvas" style="display:none;"></canvas>
<div class="toolbar" id="drawToolbar" style="display:none;">
<a href="../index.html" title="V·ªÅ trang ch·ªß">
  <button id="homeBtn" style="font-size:22px;">üè†</button>
</a>
<select id="tool">
<option value="pen">‚úèÔ∏è B√∫t</option>
<option value="line">üìè ƒê∆∞·ªùng</option>
<option value="rect">‚¨õ Ch·ªØ nh·∫≠t</option>
<option value="parallelogram">‚ñ± B√¨nh h√†nh</option>
<option value="circle">‚ö™ Tr√≤n</option>
<option value="dashedLineBtn">‚Äì ‚Äì</option>
<option value="ellipseBtn">‚¨≠ Elip</option>
<!-- Th√™m 3 c√¥ng c·ª• m·ªõi -->
<option value="box">üì¶ H·ªôp 3D</option>
<option value="pyramid3">üî∫ Ch√≥p tam gi√°c</option>
<option value="pyramid4">üî≤ Ch√≥p t·ª© gi√°c</option>
<option value="sphere">‚öΩ C·∫ßu</option>
</select>
<input id="draw-width" max="5" min="1" type="range" value="2"/>
<input id="colorPicker" type="color" value="#6b21a8">
<button id="undoBtn" title="Undo">‚Ü©Ô∏è</button>
<button id="clearBtn">üßπ Xo√°</button>
<button id="saveBtn">üíæ L∆∞u</button>
<button id="exitBtn">‚ùå Tho√°t</button>
</input></div>
<script>
/* === SCRIPT V·∫º (b·∫Øt ngu·ªìn t·ª´ b2ds) === */
/* M√¨nh ch·ªâ th√™m: history (undo), v√† 3 case v·∫Ω: box, pyramid3, pyramid4.
   Kh√¥ng s·ª≠a logic v·∫Ω kh√°c. */

const canvas = document.getElementById("drawCanvas");
const ctx = canvas.getContext("2d");
const toggleBtn = document.getElementById("toggleMenu");
const toolbar = document.getElementById("drawToolbar");
const clearBtn = document.getElementById("clearBtn");
const saveBtn = document.getElementById("saveBtn");
const exitBtn = document.getElementById("exitBtn");
const colorPicker = document.getElementById("colorPicker");
const toolSelect = document.getElementById("tool");
const widthPicker = document.getElementById("draw-width");
const undoBtn = document.getElementById("undoBtn");

let lineWidth = 2;
widthPicker.oninput = () => lineWidth = parseInt(widthPicker.value);

let isDrawing = false;
let isDrawMode = false;
let startX = 0, startY = 0, lastX = 0, lastY = 0;
let currentTool = "pen";
let imageBeforeShape;

// HISTORY cho Undo (ho√†n t√°c n√©t g·∫ßn nh·∫•t)
let history = [];

// m∆∞·ª£t h∆°n
ctx.lineJoin = "round";
ctx.lineCap = "round";

// k√≠ch th∆∞·ªõc canvas (ƒë∆°n gi·∫£n, gi·ªØ nguy√™n nh∆∞ b2ds)
function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resizeCanvas();
window.addEventListener("resize", resizeCanvas);

// b·∫≠t/t·∫Øt v·∫Ω
toggleBtn.onclick = () => {
  isDrawMode = !isDrawMode;
  if (isDrawMode) {
    canvas.style.display = "block";
    toolbar.style.display = "flex";
    canvas.style.pointerEvents = "auto"; // b·∫≠t t∆∞∆°ng t√°c khi v·∫Ω
  } else {
    canvas.style.display = "none";
    toolbar.style.display = "none";
    canvas.style.pointerEvents = "none";
  }
};

// tho√°t
exitBtn.onclick = () => {
  isDrawMode = false;
  canvas.style.display = "none";
  toolbar.style.display = "none";
  canvas.style.pointerEvents = "none";
};

// ch·ªçn c√¥ng c·ª•
toolSelect.onchange = () => currentTool = toolSelect.value;

// undo: ho√†n t√°c 1 b∆∞·ªõc (n√©t g·∫ßn nh·∫•t)
undoBtn.onclick = () => {
  if (history.length > 0) {
    const last = history.pop();
    try {
      ctx.putImageData(last, 0, 0);
    } catch (e) {
      // n·∫øu putImageData l·ªói do mismatch k√≠ch th∆∞·ªõc, clear v√† ignore
      ctx.clearRect(0,0,canvas.width,canvas.height);
    }
  }
};

// xo√° to√†n b·ªô
clearBtn.onclick = () => ctx.clearRect(0, 0, canvas.width, canvas.height);

// l∆∞u ·∫£nh
saveBtn.onclick = () => {
  const link = document.createElement("a");
  link.download = "ban_ve.png";
  link.href = canvas.toDataURL();
  link.click();
};

// fullscreen button (gi·ªØ nguy√™n)
const fullBtn = document.createElement("button");
fullBtn.textContent = "‚õ∂ Full";
fullBtn.title = "To√†n m√†n h√¨nh";
fullBtn.onclick = () => {
  if (!document.fullscreenElement)
    document.documentElement.requestFullscreen().catch(() => {});
  else
    document.exitFullscreen();
};
toolbar.appendChild(fullBtn);

// l·∫•y v·ªã tr√≠ ch√≠nh x√°c
function getPos(e) {
  const rect = canvas.getBoundingClientRect();
  const scaleX = canvas.width / rect.width;
  const scaleY = canvas.height / rect.height;
  if (e.touches && e.touches.length > 0)
    return { x: (e.touches[0].clientX - rect.left) * scaleX, y: (e.touches[0].clientY - rect.top) * scaleY };
  return { x: (e.clientX - rect.left) * scaleX, y: (e.clientY - rect.top) * scaleY };
}

// b·∫Øt ƒë·∫ßu v·∫Ω
function startDraw(e) {
  if (!isDrawMode) return;
  e.preventDefault();
  const pos = getPos(e);

  // L∆ØU tr·∫°ng th√°i tr∆∞·ªõc khi v·∫Ω (cho Undo: ho√†n t√°c n√©t g·∫ßn nh·∫•t)
  try {
    history.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
  } catch (err) {
    // ignore n·∫øu getImageData l·ªói (v√≠ d·ª• canvas ch∆∞a c√≥ k√≠ch th∆∞·ªõc)
  }

  isDrawing = true;
  startX = lastX = pos.x;
  startY = lastY = pos.y;
  ctx.strokeStyle = colorPicker.value;
  ctx.lineWidth = lineWidth;
  ctx.beginPath();
  ctx.moveTo(startX, startY);
  if (currentTool !== "pen") {
    try { imageBeforeShape = ctx.getImageData(0, 0, canvas.width, canvas.height); } catch(e){ imageBeforeShape = null; }
  } else {
    imageBeforeShape = null;
  }
}

// v·∫Ω khi r√™
function drawMove(e) {
  if (!isDrawing || !isDrawMode) return;
  e.preventDefault();
  const pos = getPos(e);
  ctx.strokeStyle = colorPicker.value;
  ctx.lineWidth = lineWidth;
  ctx.setLineDash([]);

  if (currentTool === "pen") {
    ctx.beginPath();
    ctx.moveTo(lastX, lastY);
    ctx.lineTo(pos.x, pos.y);
    ctx.stroke();
    lastX = pos.x; lastY = pos.y;
  } else {
    // kh√¥i ph·ª•c n·ªÅn tr∆∞·ªõc shape live preview
    if (imageBeforeShape) {
      try { ctx.putImageData(imageBeforeShape, 0, 0); } catch(e){ /* ignore */ }
    } else {
      // n·∫øu kh√¥ng c√≥ imageBeforeShape, x√≥a ph·∫ßn v·∫Ω t·∫°m
      // (ƒë·ªÉ tr√°nh ch·ªìng l·ªõp)
      // ctx.clearRect(0,0,canvas.width,canvas.height);
    }

    switch (currentTool) {
      case "line":
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();
        break;

      case "dashedLineBtn":
        ctx.setLineDash([8,6]);
        ctx.beginPath();
        ctx.moveTo(startX, startY);
        ctx.lineTo(pos.x, pos.y);
        ctx.stroke();
        ctx.setLineDash([]);
        break;

      case "rect":
        ctx.strokeRect(startX, startY, pos.x - startX, pos.y - startY);
        break;

      case "circle":
        const r = Math.hypot(pos.x - startX, pos.y - startY);
        ctx.beginPath();
        ctx.arc(startX, startY, r, 0, Math.PI*2);
        ctx.stroke();
        break;

      case "ellipseBtn":
        ctx.setLineDash([6,4]);
        ctx.beginPath();
        ctx.ellipse(startX, startY, Math.abs(pos.x - startX), Math.abs(pos.y - startY), 0, 0, Math.PI*2);
        ctx.stroke();
        ctx.setLineDash([]);
        break;

      case "sphere":
        const rs = Math.abs(pos.x - startX);
        ctx.beginPath();
        ctx.arc(startX, startY, rs, 0, Math.PI*2);
        ctx.stroke();
        ctx.setLineDash([6,4]);
        ctx.beginPath();
        ctx.ellipse(startX, startY, rs, rs/2, 0, Math.PI, 2 * Math.PI);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.beginPath();
        ctx.ellipse(startX, startY, rs, rs/2, 0, 0, Math.PI);
        ctx.stroke();
        break;

      case "parallelogram":
        const width = pos.x - startX;
        const height = pos.y - startY;
        const offset = width * 0.3;
        ctx.beginPath();
        ctx.moveTo(startX + offset, startY);
        ctx.lineTo(startX + width + offset, startY);
        ctx.lineTo(startX + width - offset, startY + height);
        ctx.lineTo(startX - offset, startY + height);
        ctx.closePath();
        ctx.stroke();
        break;

      /* ==== TH√äM: BOX (H·ªòP 3D) ==== */
      case "box":
        {
          const w = pos.x - startX;
          const h = pos.y - startY;
          const depth = Math.min(Math.abs(w), Math.abs(h)) * 0.3;
          // front face
          ctx.beginPath();
          ctx.strokeRect(startX, startY, w, h);
          // back face (offset by depth up-left)
          ctx.strokeRect(startX + depth, startY - depth, w, h);
          // connect corners
          ctx.beginPath();
          ctx.moveTo(startX, startY);
          ctx.lineTo(startX + depth, startY - depth);
          ctx.moveTo(startX + w, startY);
          ctx.lineTo(startX + w + depth, startY - depth);
          ctx.moveTo(startX, startY + h);
          ctx.lineTo(startX + depth, startY + h - depth);
          ctx.moveTo(startX + w, startY + h);
          ctx.lineTo(startX + w + depth, startY + h - depth);
          ctx.stroke();
        }
        break;

      /* ==== TH√äM: CH√ìP TAM GI√ÅC (pyramid3) ==== */
      /* ==== C·∫¢I TI·∫æN: CH√ìP TAM GI√ÅC 3D (pyramid3) ==== */
        case "pyramid3": {
          // x√°c ƒë·ªãnh 3 ƒë·ªânh ƒë√°y (tam gi√°c n·∫±m tr√™n m·∫∑t ph·∫≥ng ƒë√°y)
          const baseLeft = { x: startX, y: pos.y };
          const baseRight = { x: pos.x, y: pos.y };
          const baseMid = { x: (startX + pos.x) / 2, y: pos.y - (pos.y - startY) * 0.2 };

          // ƒë·ªânh ch√≥p (cao h∆°n ƒë√°y)
          const apex = { 
            x: (startX + pos.x) / 2, 
            y: startY - Math.abs(pos.y - startY) * 0.7 
          };

          ctx.beginPath();
          ctx.setLineDash([]); // n√©t li·ªÅn

          // v·∫Ω m·∫∑t tr∆∞·ªõc (2 c·∫°nh b√™n + c·∫°nh ƒë√°y tr∆∞·ªõc)
          ctx.moveTo(apex.x, apex.y);
          ctx.lineTo(baseLeft.x, baseLeft.y);
          ctx.lineTo(baseRight.x, baseRight.y);
          ctx.closePath();
          ctx.stroke();

          // v·∫Ω c·∫°nh ph√≠a sau (·∫©n - n√©t ƒë·ª©t)
          ctx.setLineDash([6, 4]);
          ctx.beginPath();
          ctx.moveTo(apex.x, apex.y);
          ctx.lineTo(baseMid.x, baseMid.y);
          ctx.stroke();
          ctx.setLineDash([]);
          break;
        }


      /* ==== TH√äM: CH√ìP T·ª® GI√ÅC (pyramid4) ==== */
      case "pyramid4":
        {
          const w4 = pos.x - startX, h4 = pos.y - startY;
          const apexX = startX + w4 / 2;
          const apexY = startY - h4 / 1.5; // apex above the rectangle
          ctx.beginPath();
          // base rectangle (front)
          ctx.rect(startX, startY, w4, h4);
          ctx.stroke();
          // connect base corners to apex
          ctx.beginPath();
          ctx.moveTo(startX, startY);
          ctx.lineTo(apexX, apexY);
          ctx.moveTo(startX + w4, startY);
          ctx.lineTo(apexX, apexY);
          ctx.moveTo(startX, startY + h4);
          ctx.lineTo(apexX, apexY);
          ctx.moveTo(startX + w4, startY + h4);
          ctx.lineTo(apexX, apexY);
          ctx.stroke();
        }
        break;

      case "pyramid3": // duplicate safe-guard
        break;

      default:
        break;
    }
  }
}

// k·∫øt th√∫c
function endDraw() { isDrawing = false; }

canvas.addEventListener("mousedown", startDraw);
canvas.addEventListener("mousemove", drawMove);
canvas.addEventListener("mouseup", endDraw);
canvas.addEventListener("mouseleave", endDraw);
canvas.addEventListener("touchstart", startDraw, { passive: false });
canvas.addEventListener("touchmove", drawMove, { passive: false });
canvas.addEventListener("touchend", endDraw);
  </script>
<!-- Reveal.js -->
<script src="https://unpkg.com/reveal.js/dist/reveal.js"></script>
<script>
  Reveal.initialize({
  width: "100%",   // üëà chi·ªÅu r·ªông = full tr√¨nh duy·ªát
  height: "100%",  // üëà chi·ªÅu cao = full tr√¨nh duy·ªát
  margin: 0.02,    // kho·∫£ng tr·ªëng xung quanh (0 ‚Üí kh√¥ng vi·ªÅn tr·∫Øng)
  minScale: 0.2,
  maxScale: 2,
  slideNumber: true,
  center: false,
  hash: true,
  // c√°c c·∫•u h√¨nh kh√°c...
 
    hash: true,
    plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath],
    math: {
        mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
        config: 'TeX-AMS_HTML-full',
        tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            displayMath: [['$$','$$'], ['\\[','\\]']],
            balanceBraces: true,
            processEscapes: true,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
        }
    },
    transition: 'slide',
    backgroundTransition: 'fade',
    controls: true,
    progress: true,
    center: true,
    slideNumber: 'c/t'
});

</script>
<!-- ========== SCRIPT V·∫º - B·∫¢N ƒê√É S·ª¨A ·ªîN ƒê·ªäNH (KH√îNG M·∫§T LOGIC) ========== -->
<!-- ========== K·∫æT TH√öC SCRIPT V·∫º ========== -->
<script>
  // H√†m ph√°t √¢m thanh
  function playSound(src) {
    const audio = new Audio(src);
    audio.play();
  }

  // =====================
  // 1Ô∏è‚É£ TR·∫ÆC NGHI·ªÜM 4 L·ª∞A CH·ªåN
  // =====================
  function showOptionIcon(qid, selected, correct) {
    document.querySelectorAll(`#${qid} .option-icon`).forEach(ic => ic.textContent = "");
    const icon = document.getElementById(`icon-${qid}-${selected}`);
    if (icon) icon.textContent = (selected === correct) ? "‚úÖ" : "‚ùå";
  }

  function checkAnswer(qid, correct) {
    // X√≥a icon c≈©
    document.querySelectorAll(`#${qid} .option-icon`).forEach(el => el.textContent = '');
    
    // L·∫•y l·ª±a ch·ªçn
    const chosen = document.querySelector(`input[name="${qid}"]:checked`);
    if (!chosen) {
      alert("H√£y ch·ªçn m·ªôt ƒë√°p √°n!");
      playSound("../audio/wrong.mp3");
      return;
    }

    const chosenVal = chosen.value;
    const iconId = `icon-${qid}-${chosenVal}`;

    // Hi·ªÉn th·ªã ƒë√∫ng/sai + ph√°t √¢m thanh
    if (chosenVal === correct) {
      document.getElementById(iconId).textContent = '‚úÖ';
      playSound("../audio/correct.mp3");
    } else {
      document.getElementById(iconId).textContent = '‚ùå';
      document.getElementById(`icon-${qid}-${correct}`).textContent = '‚úÖ';
      playSound("../audio/wrong.mp3");
    }
  }

  // =====================
  // 2Ô∏è‚É£ C√ÇU H·ªéI ƒê√öNG / SAI
  // =====================
  
</script>
<script>
function playSound(src){
  try{
    const a = new Audio(src);
    a.volume = 0.9;
    a.play().catch(()=>{/* muted or user gesture required */});
  }catch(e){}
}

/**
 * checkTrueFalseAnswer:
 * - questionId: 'q1'
 * - correctAnswers: either an Array like ['True','False','True','True'] OR a string '['True','False',...]'
 */
function checkTrueFalseAnswer(questionId, correctAnswers){
  // normalize correctAnswers to array of strings
  if(typeof correctAnswers === 'string'){
    try{ correctAnswers = JSON.parse(correctAnswers); }
    catch(e){ 
      // fallback: try to split by comma (robust)
      correctAnswers = correctAnswers.replace(/^\[|\]$/g,'').split(',').map(s=>s.trim().replace(/^["']|["']$/g,'')); 
    }
  }
  if(!Array.isArray(correctAnswers)) return console.warn('Invalid correctAnswers for', questionId);

  const container = document.getElementById(questionId);
  if(!container){ console.warn('No container', questionId); return; }

  const optionRows = container.querySelectorAll(".option-row");
  let allCorrect = true;
  let feedbackHtml = '';

  optionRows.forEach((row, idx) => {
    const radios = row.querySelectorAll("input[type='radio']");
    let selected = null;
    radios.forEach(r => { if (r.checked) selected = r.value; });

    const expected = (correctAnswers[idx] && String(correctAnswers[idx]).toLowerCase().startsWith('t')) ? 'True' : 'False';
    const letter = String.fromCharCode(97 + idx); // a, b, c, d

    if (selected === null) {
      feedbackHtml += `M·ªánh ƒë·ªÅ ${letter}) ‚≠ï Ch∆∞a ch·ªçn<br>`;
      allCorrect = false;
    } else if (selected === expected) {
      feedbackHtml += `M·ªánh ƒë·ªÅ ${letter}) ‚úÖ ƒê√∫ng<br>`;
      // add icon near selected radio (if option-icon exists)
      const icon = row.querySelector('.option-icon');
      if(icon) icon.textContent = '‚úÖ';
    } else {
      feedbackHtml += `M·ªánh ƒë·ªÅ ${letter}) ‚ùå Sai (ch·ªçn ${selected})<br>`;
      const icon = row.querySelector('.option-icon');
      if(icon) icon.textContent = '‚ùå';
      allCorrect = false;
    }
  });

  // render feedback in .answer-check .result (create if missing)
  let resultBox = container.querySelector(".answer-check .result");
  if(!resultBox){
    resultBox = document.createElement('div');
    resultBox.className = 'result';
    resultBox.style.marginTop = '8px';
    resultBox.style.padding = '8px';
    resultBox.style.background = 'rgba(255,255,255,0.06)';
    resultBox.style.borderRadius = '6px';
    container.querySelector(".answer-check").appendChild(resultBox);
  }
  resultBox.innerHTML = feedbackHtml;

  // play sound
  if(allCorrect) playSound('../audio/correct.mp3'); else playSound('../audio/wrong.mp3');
}
</script>
<script>
function checkShortAnswer(qid, correct) {
  const input = document.getElementById(`input-${qid}`);
  const icon = document.getElementById(`icon-${qid}`);
  const resultBox = input?.closest(".answer-check");

  if (!input) return;

  const userAnswer = input.value.trim();

  // T·∫°o v√πng th√¥ng b√°o n·∫øu ch∆∞a c√≥
  let feedback = resultBox.querySelector(".result");
  if (!feedback) {
    feedback = document.createElement("div");
    feedback.className = "result";
    feedback.style.marginTop = "6px";
    feedback.style.padding = "6px";
    feedback.style.borderRadius = "6px";
    feedback.style.fontSize = "0.95em";
    resultBox.appendChild(feedback);
  }

  if (userAnswer === "") {
    icon.textContent = "‚ö†Ô∏è";
    feedback.innerHTML = "‚ùó <b>B√°o th·∫ßy ki·ªÉm tr·ª±c ti·∫øp v√¨ ch∆∞a gi·∫£i.</b>";
    playSound("../audio/wrong.mp3");
    return;
  }

  // So s√°nh kh√¥ng ph√¢n bi·ªát kho·∫£ng tr·∫Øng / ch·ªØ hoa
  if (userAnswer.toLowerCase() === correct.trim().toLowerCase()) {
    icon.textContent = "‚úÖ";
    feedback.innerHTML = "üéØ <b>ƒê√∫ng r·ªìi!</b>";
    playSound("../audio/correct.mp3");
  } else {
    icon.textContent = "‚ùå";
    feedback.innerHTML = `‚ùå Sai r·ªìi. ƒê√°p √°n ƒë√∫ng l√†: <b>${correct}</b>`;
    playSound("../audio/wrong.mp3");
  }
}
</script>
<script>
// Bi·∫øn to√†n c·ª•c
let slideMenu, menuToggle, slideList, menuOverlay;

// Kh·ªüi t·∫°o khi DOM ready
document.addEventListener('DOMContentLoaded', function() {
    slideMenu = document.getElementById('slideMenu');
    menuToggle = document.getElementById('menuToggle');
    slideList = document.getElementById('slideList');
    
    // T·∫°o overlay
    menuOverlay = document.createElement('div');
    menuOverlay.className = 'menu-overlay';
    menuOverlay.onclick = closeSlideMenu;
    document.body.appendChild(menuOverlay);
    
    // T·∫°o danh s√°ch slide
    createSlideList();
    
    // L·∫Øng nghe s·ª± ki·ªán chuy·ªÉn slide
    Reveal.addEventListener('slidechanged', updateActiveSlide);
});

// T·∫°o danh s√°ch slide
function createSlideList() {
    const slides = document.querySelectorAll('.reveal .slides section');
    let html = '';
    
    slides.forEach((slide, index) => {
        const slideTitle = getSlideTitle(slide);
        const isVertical = slide.parentNode.classList.contains('stack');
        
        if (!isVertical) {
            html += `
                <div class="slide-item" data-slide-index="${index}" onclick="goToSlide(${index})">
                    <span class="slide-number">${index + 1}</span>
                    ${slideTitle}
                </div>
            `;
        }
    });
    
    slideList.innerHTML = html;
    updateActiveSlide();
}

// L·∫•y ti√™u ƒë·ªÅ slide
function getSlideTitle(slide) {
    // ∆Øu ti√™n t√¨m h2 ƒë·∫ßu ti√™n
    const h2 = slide.querySelector('h2');
    if (h2) return h2.textContent;
    
    // N·∫øu kh√¥ng c√≥ h2, t√¨m ƒëo·∫°n ƒë·∫ßu ti√™n
    const p = slide.querySelector('p');
    if (p) return p.textContent.substring(0, 30) + '...';
    
    // M·∫∑c ƒë·ªãnh
    return `Slide ${Array.from(slide.parentNode.children).indexOf(slide) + 1}`;
}

// C·∫≠p nh·∫≠t slide ƒëang active
function updateActiveSlide() {
    const currentSlide = Reveal.getCurrentSlide();
    const slides = document.querySelectorAll('.reveal .slides section');
    const currentIndex = Array.from(slides).indexOf(currentSlide);
    
    // C·∫≠p nh·∫≠t active class
    document.querySelectorAll('.slide-item').forEach((item, index) => {
        if (index === currentIndex) {
            item.classList.add('active');
        } else {
            item.classList.remove('active');
        }
    });
}

// Chuy·ªÉn ƒë·∫øn slide c·ª• th·ªÉ
function goToSlide(index) {
    Reveal.slide(index);
    closeSlideMenu();
}

// M·ªü/ƒë√≥ng menu
function toggleSlideMenu() {
    slideMenu.classList.toggle('active');
    menuOverlay.classList.toggle('active');
}

function closeSlideMenu() {
    slideMenu.classList.remove('active');
    menuOverlay.classList.remove('active');
}

// ƒê√≥ng menu b·∫±ng ph√≠m ESC
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeSlideMenu();
    }
});
</script>
<script>
function updateClock() {
  const now = new Date();
  const h = String(now.getHours()).padStart(2, '0');
  const m = String(now.getMinutes()).padStart(2, '0');
  const s = String(now.getSeconds()).padStart(2, '0');
  document.getElementById("clock").textContent = `${h}:${m}:${s}`;
}
setInterval(updateClock, 1000);
updateClock(); // ch·∫°y ngay khi t·∫£i trang
</script>
<script>
// === AUTO FIX SLIDE STRUCTURE ===
// M·ª•c ƒë√≠ch: ƒê∆∞a m·ªçi <img> (ho·∫∑c <center><img>...</center>) n·∫±m ngo√†i <section> v√†o slide h·ª£p l·ªá
document.addEventListener("DOMContentLoaded", () => {
  const slides = document.querySelector(".reveal .slides");
  if (!slides) return;

  // T·∫°o slide m·ªõi ch·ª©a node
  const makeSlide = (node) => {
    const sec = document.createElement("section");
    sec.appendChild(node);
    return sec;
  };

  // 1Ô∏è‚É£ Di chuy·ªÉn ·∫£nh ho·∫∑c center ch∆∞a n·∫±m trong slide n√†o v√†o slide m·ªõi
  const imgs = [...document.querySelectorAll(".reveal .slides img")];
  imgs.forEach(img => {
    // Ki·ªÉm tra c√≥ n·∫±m trong slide h·ª£p l·ªá kh√¥ng
    let ancestor = img.closest(".reveal .slides > section");
    if (!ancestor) {
      // N·∫øu n·∫±m trong <center>, di chuy·ªÉn c·∫£ center
      const wrap = img.closest("center") || img;
      slides.appendChild(makeSlide(wrap));
    }
  });

  // 2Ô∏è‚É£ S·ª≠a c√°c <section> b·ªã l·ªìng ho·∫∑c ƒë√≥ng sai
  const badNested = [...slides.querySelectorAll("section section")];
  badNested.forEach(sec => slides.appendChild(sec));

  // 3Ô∏è‚É£ X√≥a c√°c section r·ªóng (ch·ªâ ch·ª©a kho·∫£ng tr·∫Øng)
  [...slides.querySelectorAll("section")].forEach(sec => {
    if (!sec.innerHTML.trim()) sec.remove();
  });

  console.log("‚úÖ Slide structure fixed: images moved into valid slides.");
});
</script>
<!----------------->
<!-- LOGIN MODAL (th√™m v√†o n·∫øu ch∆∞a c√≥) -->
<div id="login-modal" style="display:none; position:fixed; inset:0; z-index:12000; 
     background: rgba(0,0,0,0.5); align-items:center; justify-content:center;">
<div style="background:#fff; color:#000; padding:20px; border-radius:8px; width:340px;">
<h3>ƒêƒÉng nh·∫≠p h·ªçc sinh</h3>
<form id="code-login-form">
<input id="login-code" placeholder="M√£ h·ªçc sinh" required="" style="width:100%;padding:8px;margin:6px 0;" type="text"/>
<input id="student-name" placeholder="H·ªç t√™n (t√πy ch·ªçn)" style="width:100%;padding:8px;margin:6px 0;" type="text"/>
<div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
<button style="padding:6px 10px;" type="submit">ƒêƒÉng nh·∫≠p</button>
<button id="close-modal" style="padding:6px 10px;" type="button">ƒê√≥ng</button>
</div>
</form>
<div id="auth-status" style="margin-top:8px;color:#333;font-weight:600;"></div>
</div>
</div>
<script type="module">
// N·∫øu ch∆∞a khai b√°o global flag, kh·ªüi t·∫°o
if (typeof window.isScoreCalculated === 'undefined') window.isScoreCalculated = false;

function calculateScore() {
  if (window.isScoreCalculated) return;
  const studentAnswers = {};
  const correctAnswers = {};
  let totalScore = 0;

  document.querySelectorAll('.question').forEach(q => {
    const qid = q.id;
    if (!qid) return;
    const btn = q.querySelector('button[onclick*="check"]');
    const onclickStr = btn ? (btn.getAttribute('onclick') || '') : '';

    if (onclickStr.includes('checkTrueFalseAnswer')) {
      const arrMatch = onclickStr.match(/\[(.*?)\]/);
      if (arrMatch) {
        const arr = arrMatch[1].split(',').map(s => s.replace(/['"\s\[\]]/g, '').trim());
        if (arr.length) correctAnswers[qid] = arr;
      }
    } else if (onclickStr.includes('checkShortAnswer')) {
      const m = onclickStr.match(/checkShortAnswer\(['"]([^'"]+)['"]\s*,\s*['"]([^'"]+)['"]\)/);
      if (m) correctAnswers[m[1]] = m[2];
    } else if (onclickStr.includes('checkAnswer')) {
      const m = onclickStr.match(/checkAnswer\(['"]([^'"]+)['"]\s*,\s*['"]([A-Za-z0-9]+)['"]\)/);
      if (m) correctAnswers[m[1]] = m[2].toString().toUpperCase();
    }
  });

  for (let i = 1; i <= 12; i++) {
    const name = 'q' + i;
    const selected = document.querySelector(`input[name="${name}"]:checked`);
    studentAnswers[name] = selected ? selected.value.trim() : '';
  }

  for (let i = 13; i <= 16; i++) {
    const sub = [];
    ['a','b','c','d'].forEach(letter => {
      const sel = document.querySelector(`input[name="q${i}${letter}"]:checked`);
      sub.push(sel ? sel.value.trim() : '');
    });
    studentAnswers['q' + i] = sub;
  }

  for (let i = 17; i <= 22; i++) {
    const el = document.getElementById(`input-q${i}`);
    studentAnswers['q' + i] = el ? el.value.trim().replace(',', '.') : '';
  }

  document.querySelectorAll('.question').forEach(q => {
    const qid = q.id;
    if (!correctAnswers[qid]) {
      const dataCorrect = q.getAttribute('data-correct');
      if (dataCorrect) {
        try {
          const parsed = JSON.parse(dataCorrect);
          correctAnswers[qid] = parsed;
        } catch (e) {
          correctAnswers[qid] = dataCorrect;
        }
      }
    }
  });

  for (let i = 1; i <= 22; i++) {
    const key = 'q' + i;
    const userAns = studentAnswers[key];
    const corr = correctAnswers[key];
    if (i >= 1 && i <= 12) {
      if (!corr) continue;
      if (userAns && String(userAns).toUpperCase() === String(corr).toUpperCase()) totalScore += 0.25;
    } else if (i >= 13 && i <= 16) {
      if (!Array.isArray(corr) || !Array.isArray(userAns)) continue;
      let correctCount = 0;
      for (let j = 0; j < corr.length && j < userAns.length; j++) {
        const exp = String(corr[j]).toLowerCase();
        const u = String(userAns[j]).toLowerCase();
        if (u && (u === exp || (exp.startsWith('t') && u.startsWith('t')) || (exp.startsWith('ƒë') && u.startsWith('ƒë')))) {
          correctCount++;
        }
      }
      if (correctCount === 1) totalScore += 0.1;
      else if (correctCount === 2) totalScore += 0.25;
      else if (correctCount === 3) totalScore += 0.5;
      else if (correctCount === 4) totalScore += 1;
    } else if (i >= 17 && i <= 22) {
      if (typeof corr === 'undefined') continue;
      const userNum = parseFloat((userAns || '').toString().replace(',', '.'));
      const corrNum = parseFloat((corr || '').toString().replace(',', '.'));
      if (!isNaN(userNum) && !isNaN(corrNum)) {
        if (Math.abs(userNum - corrNum) < 0.001) totalScore += 0.5;
      } else {
        if ((userAns || '').toString().trim().toLowerCase() === (corr || '').toString().trim().toLowerCase()) {
          totalScore += 0.5;
        }
      }
    }
  }

  let box = document.getElementById('score-result');
  if (!box) {
    box = document.createElement('div');
    box.id = 'score-result';
    box.style.cssText = 'position:fixed; bottom:15px; right:15px; background:rgba(0,0,0,0.8); color:#fff; padding:10px 14px; border-radius:8px; z-index:99999; font-size:16px;';
    document.body.appendChild(box);
  }
  box.innerHTML = `üìä T·ªïng ƒëi·ªÉm c·ªßa b·∫°n: <b>${totalScore.toFixed(2)}</b> / 10`;

  try { playSound(totalScore >= 5 ? "../audio/correct.mp3" : "../audio/wrong.mp3"); } catch(e){}
  if (typeof saveAttempt === 'function') {
    saveAttempt(document.title || 'de1', { studentAnswers, correctAnswers }, totalScore.toFixed(2));
  }
  console.log('=== correctAnswers ===', correctAnswers);
  console.log('=== studentAnswers ===', studentAnswers);
  console.log('=== totalScore ===', totalScore);
  window.isScoreCalculated = true;
}

document.getElementById('scoreBtn')?.addEventListener('click', calculateScore);
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp, query, where, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

// === C·∫§U H√åNH FIREBASE ===
const firebaseConfig = {
  apiKey: "AIzaSyDDACFZgZazMOnjzmGM_lrKswVcsoTFHxA",
  authDomain: "veonline-3bcbf.firebaseapp.com",
  projectId: "veonline-3bcbf",
  storageBucket: "veonline-3bcbf.appspot.com",
  messagingSenderId: "83902304195",
  appId: "1:83902304195:web:2f9ec1ee0c23d6e21bb776"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// === X·ª¨ L√ù ƒêƒÇNG NH·∫¨P ===
const codeForm = document.getElementById('code-login-form');
if (codeForm) {
  codeForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const code = document.getElementById('login-code').value.trim();
    const name = document.getElementById('student-name').value.trim();

    try {
      const codesRef = collection(db, "codes");
      const q = query(codesRef, where("code", "==", code));
      const querySnapshot = await getDocs(q);

      if (!querySnapshot.empty) {
        localStorage.setItem("studentCode", code);
        localStorage.setItem("studentName", name);
        document.getElementById('login-modal').style.display = 'none';
        alert('‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng!');
      } else {
        alert('‚ùå M√£ kh√¥ng h·ª£p l·ªá!');
      }
    } catch (err) {
      alert('‚ùå L·ªói: ' + err.message);
    }
  });
}

document.getElementById('loginBtn')?.addEventListener('click', (e) => {
  e.preventDefault();
  const studentCode = localStorage.getItem("studentCode");
  if (studentCode) {
    localStorage.removeItem("studentCode");
    localStorage.removeItem("studentName");
    alert('ƒê√£ ƒëƒÉng xu·∫•t');
  } else {
    document.getElementById('login-modal').style.display = 'flex';
  }
});

document.getElementById('close-modal')?.addEventListener('click', () => {
  document.getElementById('login-modal').style.display = 'none';
});

// === L∆ØU K·∫æT QU·∫¢ L√ÄM B√ÄI (C√ì CHI TI·∫æT) ===

window.saveAttempt = async function saveAttempt(testId, detailsOrScore, maybeScore) {
  const code = localStorage.getItem("studentCode");
  const name = localStorage.getItem("studentName");
  if (!code || !name) {
    alert("‚ö†Ô∏è Vui l√≤ng ƒëƒÉng nh·∫≠p tr∆∞·ªõc khi l∆∞u!");
    return;
  }

  let answers = {};
  let totalScore = 0;

  // Nh·∫≠n d·∫°ng c√°ch g·ªçi
  if (typeof detailsOrScore === "object" && maybeScore !== undefined) {
    // G·ªçi d·∫°ng: saveAttempt(testId, { studentAnswers, correctAnswers }, totalScore)
    answers = detailsOrScore.studentAnswers || {};
    totalScore = parseFloat(maybeScore);
  } else {
    // G·ªçi d·∫°ng: saveAttempt(testId, totalScore)
    totalScore = parseFloat(detailsOrScore);
  }

  try {
    await addDoc(collection(db, "attempts"), {
      code,
      name,
      testId,
      score: totalScore,         // ‚úÖ Ghi r√µ c·ªôt ƒëi·ªÉm t·ªïng k·∫øt
      answers,                   // C√≥ th·ªÉ b·ªè n·∫øu kh√¥ng c·∫ßn chi ti·∫øt
      createdAt: serverTimestamp()
    });
    console.log("‚úÖ ƒê√£ l∆∞u ƒëi·ªÉm:", totalScore);
  } catch (err) {
    console.error("‚ùå L·ªói l∆∞u:", err);
  }
}

// Override checkAnswer, checkTrueFalseAnswer, checkShortAnswer to lock and optionally savePartial
window.checkAnswer = function(qid, correct) {
  // X√≥a icon c≈©
  document.querySelectorAll(`#${qid} .option-icon`).forEach(el => el.textContent = '');

  // L·∫•y l·ª±a ch·ªçn
  const chosen = document.querySelector(`input[name="${qid}"]:checked`);
  if (!chosen) {
    alert("H√£y ch·ªçn m·ªôt ƒë√°p √°n!");
    playSound("../audio/wrong.mp3");
    return;
  }

  const chosenVal = chosen.value;
  const iconId = `icon-${qid}-${chosenVal}`;

  // Hi·ªÉn th·ªã ƒë√∫ng/sai + ph√°t √¢m thanh
  if (chosenVal === correct) {
    const el = document.getElementById(iconId);
    if (el) el.textContent = '‚úÖ';
    playSound("../audio/correct.mp3");
    // kh√≥a l·ª±a ch·ªçn
    document.querySelectorAll(`input[name="${qid}"]`).forEach(el=>el.disabled=true);
    if (isLoggedIn()) {
      try { savePartial(qid, chosenVal, correct, true); } catch(e){}
    }
  } else {
    const el = document.getElementById(iconId);
    if (el) el.textContent = '‚ùå';
    const corrEl = document.getElementById(`icon-${qid}-${correct}`);
    if (corrEl) corrEl.textContent = '‚úÖ';
    playSound("../audio/wrong.mp3");
    document.querySelectorAll(`input[name="${qid}"]`).forEach(el=>el.disabled=true);
    if (isLoggedIn()) {
      try { savePartial(qid, chosenVal, correct, false); } catch(e){}
    }
  }
};

// Override checkTrueFalseAnswer
window.checkTrueFalseAnswer = function(questionId, correctAnswers) {
  if(typeof correctAnswers === 'string'){
    try{ correctAnswers = JSON.parse(correctAnswers); }
    catch(e){ 
      correctAnswers = correctAnswers.replace(/^\[|\]$/g,'').split(',').map(s=>s.trim().replace(/^["']|["']$/g,'')); 
    }
  }
  if(!Array.isArray(correctAnswers)) return console.warn('Invalid correctAnswers for', questionId);

  const container = document.getElementById(questionId);
  if(!container){ console.warn('No container', questionId); return; }

  const optionRows = container.querySelectorAll(".option-row");
  let allCorrect = true;
  let feedbackHtml = '';

  optionRows.forEach((row, idx) => {
    const radios = row.querySelectorAll("input[type='radio']");
    let selected = null;
    radios.forEach(r => { if (r.checked) selected = r.value; });

    const expected = (correctAnswers[idx] && String(correctAnswers[idx]).toLowerCase().startsWith('t')) ? 'True' : 'False';
    const letter = String.fromCharCode(97 + idx); // a, b, c, d

    if (selected === null) {
      feedbackHtml += `M·ªánh ƒë·ªÅ ${letter}) ‚≠ï Ch∆∞a ch·ªçn<br>`;
      allCorrect = false;
    } else if (selected === expected) {
      feedbackHtml += `M·ªánh ƒë·ªÅ ${letter}) ‚úÖ ƒê√∫ng<br>`;
      const icon = row.querySelector('.option-icon');
      if(icon) icon.textContent = '‚úÖ';
    } else {
      feedbackHtml += `M·ªánh ƒë·ªÅ ${letter}) ‚ùå Sai (ch·ªçn ${selected})<br>`;
      const icon = row.querySelector('.option-icon');
      if(icon) icon.textContent = '‚ùå';
      allCorrect = false;
    }
  });

  let resultBox = container.querySelector(".answer-check .result");
  if(!resultBox){
    resultBox = document.createElement('div');
    resultBox.className = 'result';
    resultBox.style.marginTop = '8px';
    resultBox.style.padding = '8px';
    resultBox.style.background = 'rgba(255,255,255,0.06)';
    resultBox.style.borderRadius = '6px';
    container.querySelector(".answer-check").appendChild(resultBox);
  }
  resultBox.innerHTML = feedbackHtml;

  // kh√≥a inputs c·ªßa c√¢u n√†y
  container.querySelectorAll("input[type='radio']").forEach(r=>r.disabled=true);

  // l∆∞u partial t·ª´ng m·ªánh ƒë·ªÅ n·∫øu ƒëƒÉng nh·∫≠p
  if (isLoggedIn()) {
    optionRows.forEach((row, idx) => {
      const sel = row.querySelector("input[type='radio']:checked");
      const user = sel ? sel.value : '';
      const expected = (correctAnswers[idx] && String(correctAnswers[idx]).toLowerCase().startsWith('t')) ? 'True' : 'False';
      try { savePartial(questionId + '_' + idx, user, expected, user === expected); } catch(e){}
    });
  }

  if(allCorrect) playSound('../audio/correct.mp3'); else playSound('../audio/wrong.mp3');
};

// Override checkShortAnswer
window.checkShortAnswer = function(qid, correct) {
  const input = document.getElementById(`input-${qid}`);
  const icon = document.getElementById(`icon-${qid}`);
  const resultBox = input?.closest(".answer-check");

  if (!input) return;

  const userAnswer = input.value.trim();

  // T·∫°o v√πng th√¥ng b√°o n·∫øu ch∆∞a c√≥
  let feedback = resultBox.querySelector(".result");
  if (!feedback) {
    feedback = document.createElement("div");
    feedback.className = "result";
    feedback.style.marginTop = "6px";
    feedback.style.padding = "6px";
    feedback.style.borderRadius = "6px";
    feedback.style.fontSize = "0.95em";
    resultBox.appendChild(feedback);
  }

  if (userAnswer === "") {
    icon.textContent = "‚ö†Ô∏è";
    feedback.innerHTML = "‚ùó <b>B√°o th·∫ßy ki·ªÉm tr·ª±c ti·∫øp v√¨ ch∆∞a gi·∫£i.</b>";
    playSound("../audio/wrong.mp3");
    return;
  }

  if (userAnswer.toLowerCase() === correct.trim().toLowerCase()) {
    icon.textContent = "‚úÖ";
    feedback.innerHTML = "üéØ <b>ƒê√∫ng r·ªìi!</b>";
    input.disabled = true;
    if (isLoggedIn()) {
      try { savePartial(qid, userAnswer, correct, true); }catch(e){}
    }
    playSound("../audio/correct.mp3");
  } else {
    icon.textContent = "‚ùå";
    feedback.innerHTML = `‚ùå Sai r·ªìi. ƒê√°p √°n ƒë√∫ng l√†: <b>${correct}</b>`;
    input.disabled = true;
    if (isLoggedIn()) {
      try { savePartial(qid, userAnswer, correct, false); }catch(e){}
    }
    playSound("../audio/wrong.mp3");
  }
};

// Override calculateScore: only save if logged in
if (typeof window.isScoreCalculated === 'undefined') window.isScoreCalculated = false;
window.calculateScore = function() {
  if (window.isScoreCalculated) return;
  const studentAnswers = {};
  const correctAnswers = {};
  let totalScore = 0;

  // gather correct answers from onclicks or data-correct
  document.querySelectorAll('.question').forEach(q => {
    const qid = q.id;
    if (!qid) return;
    const btn = q.querySelector('button[onclick*="check"]');
    const onclickStr = btn ? (btn.getAttribute('onclick') || '') : '';

    if (onclickStr.includes('checkTrueFalseAnswer')) {
      const arrMatch = onclickStr.match(/\[(.*?)\]/);
      if (arrMatch) {
        const arr = arrMatch[1].split(',').map(s => s.replace(/['"\s\[\]]/g, '').trim());
        if (arr.length) correctAnswers[qid] = arr;
      }
    } else if (onclickStr.includes('checkShortAnswer')) {
      const m = onclickStr.match(/checkShortAnswer\(['"]([^'"]+)['"]\s*,\s*['"]([^'"]+)['"]\)/);
      if (m) correctAnswers[m[1]] = m[2];
    } else if (onclickStr.includes('checkAnswer')) {
      const m = onclickStr.match(/checkAnswer\(['"]([^'"]+)['"]\s*,\s*['"]([A-Za-z0-9]+)['"]\)/);
      if (m) correctAnswers[m[1]] = m[2].toString().toUpperCase();
    }

    // fallback data-correct
    if (!correctAnswers[qid]) {
      const dataCorrect = q.getAttribute('data-correct');
      if (dataCorrect) {
        try { correctAnswers[qid] = JSON.parse(dataCorrect); } catch(e) { correctAnswers[qid] = dataCorrect; }
      }
    }
  });

  for (let i = 1; i <= 12; i++) {
    const name = 'q' + i;
    const selected = document.querySelector(`input[name="${name}"]:checked`);
    studentAnswers[name] = selected ? selected.value.trim() : '';
  }

  for (let i = 13; i <= 16; i++) {
    const sub = [];
    ['a','b','c','d'].forEach(letter => {
      const sel = document.querySelector(`input[name="q${i}${letter}"]:checked`);
      sub.push(sel ? sel.value.trim() : '');
    });
    studentAnswers['q' + i] = sub;
  }

  for (let i = 17; i <= 22; i++) {
    const el = document.getElementById(`input-q${i}`);
    studentAnswers['q' + i] = el ? el.value.trim().replace(',', '.') : '';
  }

  for (let i = 1; i <= 22; i++) {
    const key = 'q' + i;
    const userAns = studentAnswers[key];
    const corr = correctAnswers[key];
    if (i >= 1 && i <= 12) {
      if (!corr) continue;
      if (userAns && String(userAns).toUpperCase() === String(corr).toUpperCase()) totalScore += 0.25;
    } else if (i >= 13 && i <= 16) {
      if (!Array.isArray(corr) || !Array.isArray(userAns)) continue;
      let correctCount = 0;
      for (let j = 0; j < corr.length && j < userAns.length; j++) {
        const exp = String(corr[j]).toLowerCase();
        const u = String(userAns[j]).toLowerCase();
        if (u && (u === exp || (exp.startsWith('t') && u.startsWith('t')) || (exp.startsWith('ƒë') && u.startsWith('ƒë')))) {
          correctCount++;
        }
      }
      if (correctCount === 1) totalScore += 0.1;
      else if (correctCount === 2) totalScore += 0.25;
      else if (correctCount === 3) totalScore += 0.5;
      else if (correctCount === 4) totalScore += 1;
    } else if (i >= 17 && i <= 22) {
      if (typeof corr === 'undefined') continue;
      const userNum = parseFloat((userAns || '').toString().replace(',', '.'));
      const corrNum = parseFloat((corr || '').toString().replace(',', '.'));
      if (!isNaN(userNum) && !isNaN(corrNum)) {
        if (Math.abs(userNum - corrNum) < 0.001) totalScore += 0.5;
      } else {
        if ((userAns || '').toString().trim().toLowerCase() === (corr || '').toString().trim().toLowerCase()) {
          totalScore += 0.5;
        }
      }
    }
  }

  let box = document.getElementById('score-result');
  if (!box) {
    box = document.createElement('div');
    box.id = 'score-result';
    box.style.cssText = 'position:fixed; bottom:15px; right:15px; background:rgba(0,0,0,0.8); color:#fff; padding:10px 14px; border-radius:8px; z-index:99999; font-size:16px;';
    document.body.appendChild(box);
  }
  box.innerHTML = `üìä T·ªïng ƒëi·ªÉm c·ªßa b·∫°n: <b>${totalScore.toFixed(2)}</b> / 10`;

  try { playSound(totalScore >= 5 ? "../audio/correct.mp3" : "../audio/wrong.mp3"); } catch(e){}
  if (isLoggedIn() && typeof saveAttempt === 'function') {
    saveAttempt(document.title || 'de1', { studentAnswers, correctAnswers }, totalScore.toFixed(2));
    box.innerHTML += '<br/><small style="opacity:0.95">‚úÖ K·∫øt qu·∫£ ƒë√£ l∆∞u (t√†i kho·∫£n ƒëƒÉng nh·∫≠p)</small>';
  } else {
    box.innerHTML += '<br/><small style="opacity:0.8">‚ÑπÔ∏è Ch∆∞a ƒëƒÉng nh·∫≠p ‚Äî k·∫øt qu·∫£ ch·ªâ hi·ªÉn th·ªã tr√™n tr√¨nh duy·ªát.</small>';
  }
  console.log('=== correctAnswers ===', correctAnswers);
  console.log('=== studentAnswers ===', studentAnswers);
  console.log('=== totalScore ===', totalScore);
  window.isScoreCalculated = true;
};

document.getElementById('scoreBtn')?.addEventListener('click', () => {
  // reset flag to allow re-calc during testing if desired
  window.isScoreCalculated = false;
  window.calculateScore();
});
</script>
</body>
</html>
