<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TÀI LIỆU TOÁN HỌC</title>

  <!-- Polyfill ES6 -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

  <!-- MathJax -->
  <script async id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <!-- Tailwind CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Slick Carousel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>

  <!-- Font Awesome -->
   <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   <!-- Custom CSS -->
  <link rel="stylesheet" href="styles1.css">
</head>

<body>
    <!-- Thay thế toàn bộ phần <header> hiện tại bằng code này -->
 <header>
        <div class="header-container">
             <div class="logo">
            <img src="logo3.jpg" alt="" class="logo-img">
            <div class="logo-text">
                <h1>EDUCODE </h1>
                <p>Chia sẻ & Truyền cảm hứng học toán</p>
            </div>
        </div>

             <button class="hamburger-btn">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>

            <nav id="mainNav">
                <ul class="main-menu">
                    <li><a href="../index.html">Trang chủ</a></li>
                    <li>
                        <a href="#courses">Chuyên đề 12 <i class="fas fa-chevron-down dropdown-icon"></i></a>
                        <ul class="submenu">
                            <li>
                                <a href="#math">Đạo hàm và ứng dụng <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C1B1">Biến thiên và cực trị hàm số</a></li>
                                    <li><a href="12C1B2">Max - min của hàm số</a></li>
                                    <li><a href="12C1B3">Tiệm cận</a></li>
                                    <li><a href="12C1B4">Đồ thị hàm số</a></li>
                                      </ul>
                            </li>
                            <li>
                                <a href="#math">Véc tơ và hệ tọa độ KG <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C2B1">Véc tơ trong KG</a></li>
                                    <li><a href="12C2B1">Hệ tọa độ trong KG</a></li>
                                    <li><a href="12C2B3">Biểu thức tọa độ</a></li>
                                    
                                </ul>
                            </li>
                            <li>
                                <a href="#chemistry"> Thống kê <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C3B1">Bài 1</a></li>
                                    <li><a href="12C3B2">Bài 2</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#math">Nguyên hàm,tích phân <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C4B1">Nguyên hàm</a></li>
                                    <li><a href="12C4B1">Tích phân</a></li>
                                    <li><a href="12C4B3">Ứng dụng </a></li>
                                    
                                </ul>
                            </li>
                            <li>
                                <a href="#chemistry"> PT trong KG <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C5B1">Bài 1</a></li>
                                    <li><a href="12C5B2">Bài 2</a></li>
                                    <li><a href="12C5B2">Bài 3</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="#chemistry"> Xác suất <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C6B1">Bài 1</a></li>
                                    <li><a href="12C6B2">Bài 2</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#resources">Trắc nghiệm <i class="fas fa-chevron-down dropdown-icon"></i></a>
                        <ul class="submenu">
                            <li>
                                <a href="#math-resources">Chương 1 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C1B1TN">Biến thiên và cực trị hàm số</a></li>
                                    <li><a href="12C1B2TN">Max - min của hàm số</a></li>
                                    <li><a href="12C1B3TN">Tiệm cận</a></li>
                                    <li><a href="12C1B4TN">Đồ thị hàm số</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 2 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C2B1TN">Véc tơ trong KG</a></li>
                                    <li><a href="12C2B1TN">Hệ tọa độ trong KG</a></li>
                                    <li><a href="12C2B3TN">Biểu thức tọa độ</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 3 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C3B1TN">Bài 1</a></li>
                                    <li><a href="12C3B2TN">Bài 2</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 4 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C4B1TN">Nguyên hàm</a></li>
                                    <li><a href="12C4B1TN">Tích phân</a></li>
                                    <li><a href="12C4B3TN">Ứng dụng </a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 5 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C5B1TN">Bài 1</a></li>
                                    <li><a href="12C5B2TN">Bài 2</a></li>
                                    <li><a href="12C5B2TN">Bài 3</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 6 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C6B1TN">Bài 1</a></li>
                                    <li><a href="12C6B2TN">Bài 2</a></li>
                                </ul>
                            </li>
                          </ul>
                    </li>
                    <li>
                        <a href="#resources">Đúng sai <i class="fas fa-chevron-down dropdown-icon"></i></a>
                        <ul class="submenu">
                            <li>
                                <a href="#math-resources">Chương 1 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C1B1DS">Biến thiên và cực trị hàm số</a></li>
                                    <li><a href="12C1B2DS">Max - min của hàm số</a></li>
                                    <li><a href="12C1B3DS">Tiệm cận</a></li>
                                    <li><a href="12C1B4DS">Đồ thị hàm số</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 2 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C2B1DS">Véc tơ trong KG</a></li>
                                    <li><a href="12C2B1DS">Hệ tọa độ trong KG</a></li>
                                    <li><a href="12C2B3DS">Biểu thức tọa độ</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 3 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C3B1DS">Bài 1</a></li>
                                    <li><a href="12C3B1DS">Bài 2</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 4 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C4B1DS">Nguyên hàm</a></li>
                                    <li><a href="12C4B1DS">Tích phân</a></li>
                                    <li><a href="12C4B1DS">Ứng dụng </a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 5 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C5B1DS">Bài 1</a></li>
                                    <li><a href="12C5B1DS">Bài 2</a></li>
                                    <li><a href="12C5B1DS">Bài 3</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 6 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C5B1DS">Bài 1</a></li>
                                    <li><a href="12C5B1DS">Bài 2</a></li>
                                </ul>
                            </li>
                          </ul>
                    </li>
                    <li>
                        <a href="#resources">Trả lời ngắn <i class="fas fa-chevron-down dropdown-icon"></i></a>
                        <ul class="submenu">
                            <li>
                                <a href="#math-resources">Chương 1 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C1B1TLN">Biến thiên và cực trị hàm số</a></li>
                                    <li><a href="12C1B2TLN">Max - min của hàm số</a></li>
                                    <li><a href="12C1B3TLN">Tiệm cận</a></li>
                                    <li><a href="12C1B4TLN">Đồ thị hàm số</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 2 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C2B1TLN">Véc tơ trong KG</a></li>
                                    <li><a href="12C2B1TLN">Hệ tọa độ trong KG</a></li>
                                    <li><a href="12C2B3TLN">Biểu thức tọa độ</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 3 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C3B1TLN">Bài 1</a></li>
                                    <li><a href="12C3B2TLN">Bài 2</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 4 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C4B1TLN">Nguyên hàm</a></li>
                                    <li><a href="12C4B1TLN">Tích phân</a></li>
                                    <li><a href="12C4B3TLN">Ứng dụng </a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 5 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C5B1TLN">Bài 1</a></li>
                                    <li><a href="12C5B2TLN">Bài 2</a></li>
                                    <li><a href="12C5B2TLN">Bài 3</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 6 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C6B1TLN">Bài 1</a></li>
                                    <li><a href="12C6B2TLN">Bài 2</a></li>
                                </ul>
                            </li>
                          </ul>
                    </li>
                    <li>
                        <a href="#resources">Toán thực tế <i class="fas fa-chevron-down dropdown-icon"></i></a>
                        <ul class="submenu">
                            <li>
                                <a href="#math-resources">Chương 1 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C1B1TT">Biến thiên và cực trị hàm số</a></li>
                                    <li><a href="12C1B2TT">Max - min của hàm số</a></li>
                                    <li><a href="12C1B3TT">Tiệm cận</a></li>
                                    <li><a href="12C1B4TT">Đồ thị hàm số</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 2 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C2B1TT">Véc tơ trong KG</a></li>
                                    <li><a href="12C2B1TT">Hệ tọa độ trong KG</a></li>
                                    <li><a href="12C2B3TT">Biểu thức tọa độ</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 3 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C3B1TT">Bài 1</a></li>
                                    <li><a href="12C3B1TT">Bài 2</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 4 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C4B1TT">Nguyên hàm</a></li>
                                    <li><a href="12C4B2TT">Tích phân</a></li>
                                    <li><a href="12C4B3TT">Ứng dụng </a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 5 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C5B1TT">Bài 1</a></li>
                                    <li><a href="12C5B2TT">Bài 2</a></li>
                                    <li><a href="12C5B3TT">Bài 3</a></li>
                                </ul>
                            </li>
                             <li>
                                <a href="#math-resources">Chương 6 <i class="fas fa-chevron-right nested-dropdown-icon"></i></a>
                                <ul class="nested-sub-menu">
                                    <li><a href="12C6B1TT">Bài 1</a></li>
                                    <li><a href="12C6B2TT">Bài 2</a></li>
                                </ul>
                            </li>
                          </ul>
                    </li>
                   <li><a href="#" class="login-btn" id="login-button">Đăng nhập</a></li>
                </ul>
            </nav>
        </div>
    
      
    
      </header>


  <!-- Modal Đăng Nhập -->
  <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
    <div class="bg-white p-6 rounded-lg shadow-lg max-w-md w-full">
      <h2 class="text-xl font-bold mb-4 text-center">Đăng nhập bằng mã</h2>
      <form id="code-login-form">
        <input type="text" id="login-code" class="w-full p-2 mb-4 border-2 border-gray-300 rounded-lg" placeholder="Nhập mã thẻ (VD: ABC123DEF4)" required>
        <div class="flex justify-center gap-4">
          <button type="submit" class="px-6 py-2 bg-purple-800 text-white rounded-full hover:bg-purple-900">Đăng nhập</button>
          <button type="button" id="close-modal" class="px-6 py-2 bg-gray-500 text-white rounded-full hover:bg-gray-600">Đóng</button>
        </div>
      </form>
      <div id="auth-status" class="mt-4 text-center font-bold"></div>
    </div>
  </div>


<main class="main-content">
            <div id="documentViewer">
                <h1 class="article-title">CHUYÊN ĐỀ: ỨNG DỤNG ĐẠO HÀM</h1>
                <p class="doc-subtitle">Môn Toán - Lớp 12</p>
                <div class="doc-meta">
                    <span><i class="fas fa-book"></i> 7 dạng bài</span>
                    <span><i class="fas fa-lightbulb"></i> 25 ví dụ</span>
                    <span><i class="fas fa-pencil-alt"></i> 50 bài tập</span>
                    <span><i class="fas fa-calendar-alt"></i> Cập nhật: 20/08/2025</span>
                    <span><i class="fas fa-user-edit"></i> Biên soạn: ThS. Nguyễn Thanh Bình</span>
                </div>

<!-- Câu 1 -->
<div class="question" id="q1">
<div class="summary-box">
<p><strong>Câu 1</strong>. Cho đồ thị \( y = f(x) \) như hình vẽ dưới đây:<br/>
<img alt="" loading="lazy" src="data/anh2/3.1.png"/><br/>

Hàm số đã cho đồng biến trên khoảng nào trong các khoảng sau?</p>

<div class="options">
<label><input name="q1" onchange="showOptionIcon('q1', 'A', 'C')" type="radio" value="A"/> A. \( (-\infty ; 1) \)<span class="option-icon" id="icon-q1-A"></span></label>
<label><input name="q1" onchange="showOptionIcon('q1', 'B', 'C')" type="radio" value="B"/> B. \( (2 ; +\infty) \)<span class="option-icon" id="icon-q1-B"></span></label>
<label><input name="q1" onchange="showOptionIcon('q1', 'C', 'C')" type="radio" value="C"/> C. \( (0 ; 1) \)<span class="option-icon" id="icon-q1-C"></span></label>
<label><input name="q1" onchange="showOptionIcon('q1', 'D', 'C')" type="radio" value="D"/> D. \( (1 ; 2) \)<span class="option-icon" id="icon-q1-D"></span></label>
</div></div>
<div class="answer-check">
<button onclick="checkAnswer('q1', 'B')">Kiểm tra</button>
<button class="solution-toggle" onclick="toggleSolution('solution-q1')">Xem lời giải</button>
<div class="solution" id="solution-q1">
  <h4 class="font-bold mb-2">Lời giải chi tiết:</h4>
  <p>Nhìn vào đồ thị ta thấy hàm số <span class="math">\(y=f(x)\)</span> đi lên (đồng biến) trên khoảng <span class="math">\((2; +\infty)\)</span>.</p>
  <p>Các khoảng khác: 
    <br/>• \((-∞;1)\): hàm đang giảm. 
    <br/>• \((0;1)\): hàm đi xuống. 
    <br/>• \((1;2)\): hàm vẫn giảm.
  </p>
  <p>👉 Vậy đáp án đúng là <strong>B</strong>.</p>
</div>

</div>
</div>

<!-- Câu 2 -->
<div class="question" id="q2">
<div class="summary-box">
<p><strong>Câu 2</strong>. Trong không gian \( Oxyz \), cho mặt phẳng \( (P): 2x + y - z - 1 = 0 \). Vector nào dưới đây là một vector pháp tuyến của mặt phẳng \( (P) \)?</p>

<div class="options">
<label><input name="q2" onchange="showOptionIcon('q2', 'A', 'A')" type="radio" value="A"/> A. \( \overrightarrow{n_3} = (2 ; 1 ; -1) \)<span class="option-icon" id="icon-q2-A"></span></label>
<label><input name="q2" onchange="showOptionIcon('q2', 'B', 'A')" type="radio" value="B"/> B. \( \overrightarrow{n_1} = (2 ; -1 ; 1) \)<span class="option-icon" id="icon-q2-B"></span></label>
<label><input name="q2" onchange="showOptionIcon('q2', 'C', 'A')" type="radio" value="C"/> C. \( \overrightarrow{n_4} = (-2 ; 1 ; 1) \)<span class="option-icon" id="icon-q2-C"></span></label>
<label><input name="q2" onchange="showOptionIcon('q2', 'D', 'A')" type="radio" value="D"/> D. \( \overrightarrow{n_2} = (2 ; 1 ; 1) \)<span class="option-icon" id="icon-q2-D"></span></label>
</div></div>
<div class="answer-check">
<button onclick="checkAnswer('q2', 'A')">Kiểm tra</button>
<button class="solution-toggle" onclick="toggleSolution('solution-q2')">Xem lời giải</button>
<div class="solution" id="solution-q2"></div>
</div>
</div>


<h3>Phần II: Trắc Nghiệm Đúng/Sai - từ câu 1 đến câu 16</h3>

<!-- Câu 1 -->
<div class="question" id="q1">
<div class="summary-box">
<p><strong>Câu 1</strong>. Một vật chuyển động thẳng có đồ thị vận tốc - thời gian như hình bên:<br/>
<img alt="" loading="lazy" src="data/anh2/3.1.png"/><br/>
<div class="options">
<p>a) Tổng quãng đường vật đi được trong 60(s) đầu tiên là 650(m).</p>
<label><input name="q1a" type="radio" value="Đúng"/> Đúng<span class="option-icon" id="icon-q1a-Đúng"></span></label>
<label><input name="q1a" type="radio" value="Sai"/> Sai<span class="option-icon" id="icon-q1a-Sai"></span></label>
<p>b) Trong khoảng thời gian từ 0(s) đến 10(s), phương trình vận tốc của vật là \( v(t) = \frac{1}{2}t + 10 \, (\mathrm{m/s}) \).</p>
<label><input name="q1b" type="radio" value="Đúng"/> Đúng<span class="option-icon" id="icon-q1b-Đúng"></span></label>
<label><input name="q1b" type="radio" value="Sai"/> Sai<span class="option-icon" id="icon-q1b-Sai"></span></label>
<p>c) Trong khoảng thời gian từ 30(s) đến 60(s), phương trình vận tốc của vật là \( v(t) = -\frac{1}{2}t + 30 \, (\mathrm{m/s}) \).</p>
<label><input name="q1c" type="radio" value="Đúng"/> Đúng<span class="option-icon" id="icon-q1c-Đúng"></span></label>
<label><input name="q1c" type="radio" value="Sai"/> Sai<span class="option-icon" id="icon-q1c-Sai"></span></label>
<p>d) Trong khoảng thời gian từ 10(s) đến 30(s), vật chuyển động đều.</p>
<label><input name="q1d" type="radio" value="Đúng"/> Đúng<span class="option-icon" id="icon-q1d-Đúng"></span></label>
<label><input name="q1d" type="radio" value="Sai"/> Sai<span class="option-icon" id="icon-q1d-Sai"></span></label>
</div></div>
<div class="answer-check">
<button onclick="checkTrueFalseAnswer('q1', ['Đúng', 'Đúng', 'Đúng', 'Đúng'])">Kiểm tra</button>
<button class="solution-toggle" onclick="toggleSolution('solution-q1')">Xem lời giải</button>
<div class="solution" id="solution-q1"></div>
</div>
</div>


<h3>Phần III: Trắc Nghiệm Trả Lời Ngắn - từ câu 17 đến câu 22</h3>

<!-- Câu 17 -->
<div class="question" id="q17">
<div class="summary-box">
<p><strong>Câu 17</strong>. Câu lạc bộ thiện nguyện của một trường THPT dự định làm các bình hoa bằng giấy để bán trong một hội chợ gây quỹ từ thiện. Cần 1 giờ để làm một bình hoa nhỏ và sẽ bán với giá 100 nghìn đồng và 90 phút để làm một bình hoa lớn và bán với giá 200 nghìn đồng. Biết rằng câu lạc bộ có 30 giờ để làm các bình hoa và muốn tổng số bình hoa không quá 24 bình. Số tiền lớn nhất mà câu lạc bộ có thể thu được là bao nhiêu triệu đồng?</p>
</div>
<div class="answer-check">
<input type="text" id="input-q17" placeholder="Nhập đáp án">
<button onclick="checkShortAnswer('q17', '1800')">Kiểm tra</button>
<button class="solution-toggle" onclick="toggleSolution('solution-q17')">Xem lời giải</button>
<div class="solution" id="solution-q17"></div>
<div class="answer-feedback" id="feedback-q17"></div>
</div>
</div>



 <div class="score-section">
 <h3>Tính tổng điểm</h3>
    <p>Nhập họ và tên:</p>
    <input id="student-name" type="text" placeholder="Họ và tên"/>   
<button onclick="calculateScore()">Tính điểm</button>
<div id="score-result"></div>
</div>

<footer>
        <div class="footer-container">
            <div class="footer-col">
                <h3>Về Educode</h3>
                 <p>EduCode là nền tảng học online đang trên hình trình xây dưng, với kỳ vọng mang đến các khóa học toán chất lượng cao. Chúng tôi cam kết giúp bạn nắm vững kiến thức và chuẩn bị cho tương lai với các khóa học lý, hóa, tin học và AI sắp ra mắt.</p>
                <div class="social-links">
                    <a href="https://www.facebook.com/nguyen.binhthanh.5209"><i class="fab fa-facebook"></i></a>
                    <a href="#"><i class="fab fa-youtube"></i></a>
                    <a href="#"><i class="fab fa-tiktok"></i></a>
                </div>
            </div>
                          
                      
            <div class="footer-col">
                <h3>Liên hệ</h3>
                <div class="contact-info">
                    <p><i class="fas fa-phone"></i> 0878042368</p>
                    <p><i class="fas fa-envelope"></i> nguyenthanhbinh_thpt_tts@bentre.edu.vn</p>
                </div>
            </div>
            
            <div class="footer-col">
                <h3>Liên kết nhanh</h3>
                <ul>
                     <li><a href="https://meet.google.com/osh-vjqs-vdg">Học online </a></li>
                    <li><a href="12C1B1.html">Tài liệu & Đề ôn luyện</a></li>
                    <li><a href="#coming-soon">Sắp ra mắt: Lý, Hóa, AI</a></li>
                    <li><a href="#blog">Blog EduCode</a></li>
                </ul>
            </div>
            </div>
        
        <div class="copyright">
            <p>© 2025 EduCode – Thạc sĩ Nguyễn Thanh Bình. All Rights Reserved.</p>
        </div>
    </footer>
        // --- kiểm tra kết quả --//
          <script>
            function showOptionIcon(questionId, selectedValue, correctAnswer) {
              if (!checkedQuestions[questionId]) return;
              ['A', 'B', 'C', 'D'].forEach(letter => {
                const iconSpan = document.getElementById(`icon-${questionId}-${letter}`);
                if (iconSpan) iconSpan.innerHTML = '';
              });
              const icon = selectedValue === correctAnswer ? '✅' : '❌';
              const selectedSpan = document.getElementById(`icon-${questionId}-${selectedValue}`);
              if (selectedSpan) selectedSpan.innerHTML = icon;
            }
            function showTFOptionIcon(name, selectedValue, correctValue, questionId) {
              if (!checkedQuestions[questionId]) return;
              const icon = selectedValue === correctValue ? '✅' : '❌';
              const span = document.getElementById(`icon-${name}`);
              if (span) span.innerHTML = icon;
            }          
            function lockQuestionInputs(questionId) {
            const radios = document.querySelectorAll(`input[name="${questionId}"]`);
            radios.forEach(input => input.disabled = true);
        }
            function addSolutionLink(questionId, url) {
              if (!checkedQuestions[questionId]) return;
              const container = document.getElementById(`feedback-${questionId}`);
              if (container && !container.querySelector("a")) {
                const link = document.createElement("a");
                link.href = url;
                link.target = "_blank";
                link.style.marginLeft = "10px";
                link.textContent = "Xem lời giải";
                container.appendChild(link);
              }
            }
            var studentAnswers = {};
            var checkedQuestions = {};
            var isScoreCalculated = false;
            function checkAnswer(questionId, correctAnswer) {
              if (checkedQuestions[questionId]) return;
              const inputs = document.getElementsByName(questionId);
              let selectedAnswer = null;
              for (let input of inputs) {
                if (input.checked) {
                  selectedAnswer = input.value;
                  break;
                }
              }
              studentAnswers[questionId] = selectedAnswer;
              checkedQuestions[questionId] = true;
              lockQuestionInputs(questionId);
              showOptionIcon(questionId, selectedAnswer, correctAnswer);
              addSolutionLink(questionId, `giai/${questionId}.html`);
            }

            function checkTrueFalseAnswer(questionId, correctAnswers) {
          for (let i = 0; i < correctAnswers.length; i++) {
            const name = questionId + String.fromCharCode(97 + i);
            const inputs = document.getElementsByName(name);
            let selected = '';
            for (const input of inputs) {
              if (input.checked) {
                selected = input.value;
                break;
              }
            }

            const iconId = `icon-${name}`;
            let icon = document.getElementById(iconId);
            if (!icon && inputs.length) {
              icon = document.createElement('span');
              icon.id = iconId;
              icon.className = 'option-icon';
              inputs[0].parentNode.appendChild(icon);
            }
            if (icon) {
              icon.innerHTML = selected === correctAnswers[i] ? '✅' : '❌';
            }
          }
        }
          function checkShortAnswer(questionId, correctAnswer) {
              if (checkedQuestions[questionId]) return;
              const input = document.getElementById('input-' + questionId);
              const feedback = document.getElementById('feedback-' + questionId);

              // Tự động tạo span hiển thị nếu chưa tồn tại
              let icon = document.getElementById('icon-' + questionId);
              if (!icon && input) {
                icon = document.createElement('span');
                icon.id = 'icon-' + questionId;
                icon.className = 'option-icon';
                icon.setAttribute('aria-label', 'Biểu tượng kiểm tra');
                input.insertAdjacentElement('afterend', icon);
              }

              if (!input) {
                feedback.innerHTML = 'Lỗi: Không tìm thấy input cho câu hỏi!';
                feedback.className = 'answer-feedback incorrect';
                return;
              }

              const value = input.value.trim();
              if (value === '') {
                feedback.innerHTML = 'Vui lòng nhập đáp án!';
                feedback.className = 'answer-feedback incorrect';
                if (icon) icon.innerHTML = '';
                return;
              }

              if (!isNaN(correctAnswer)) {
                const numeric = parseFloat(value);
                if (isNaN(numeric)) {
                  feedback.innerHTML = 'Vui lòng nhập một số hợp lệ!';
                  feedback.className = 'answer-feedback incorrect';
                  if (icon) icon.innerHTML = '';
                  return;
                }
                const correct = parseFloat(correctAnswer);
                if (Math.abs(numeric - correct) < 0.001) {
                  feedback.innerHTML = 'Đúng!';
                  feedback.className = 'answer-feedback correct';
                  studentAnswers[questionId] = numeric;
                  if (icon) icon.innerHTML = '✅';
                } else {
                  feedback.innerHTML = 'Sai!';
                  feedback.className = 'answer-feedback incorrect';
                  studentAnswers[questionId] = numeric;
                  if (icon) icon.innerHTML = '❌';
                }
              } else {
                if (value === correctAnswer) {
                  feedback.innerHTML = 'Đúng';
                    feedback.className = 'answer-feedback correct';
                  studentAnswers[questionId] = value;
                  if (icon) icon.innerHTML = '✅';
                } else {
                  feedback.innerHTML = 'Sai!';
                  feedback.className = 'answer-feedback incorrect';
                  studentAnswers[questionId] = value;
                  if (icon) icon.innerHTML = '❌';
                }
              }
        }
   // --- Hàm tính điểm --//   
          function calculateScore() {
            if (isScoreCalculated) return;
            const correctAnswers = {
              q1: 'B', q2: 'A', q3: 'C', q4: 'B', q5: 'A', q6: 'B', q7: 'A', q8: 'B', q9: 'D', q10: 'A', q11: 'C', q12: 'B',
              q1: ['Đúng','Đúng','Đúng','Đúng'],
              q14: ['Đúng','Sai','Đúng','Sai'],
              q15: ['Sai','Đúng','Đúng','Sai'],
              q16: ['Sai','Sai','Đúng','Sai'],
              q17: '1800', q18: '12.4', q19: '0.24', q20: '95', q21: '875', q22: '55.4'
            };

            // Gom đáp án học sinh
            const studentAns = {};

            // Câu 1-12
            for (let i = 1; i <= 12; i++) {
              const name = 'q' + i;
              const sel = document.querySelector(`input[name="${name}"]:checked`);
              studentAns[name] = sel ? sel.value.trim() : '';
            }

            // Câu 1-16 (mỗi câu 4 mệnh đề)
            for (let i = 1; i <= 16; i++) {
              const arr = [];
              ['a','b','c','d'].forEach((letter) => {
                const sel = document.querySelector(`input[name="q${i}${letter}"]:checked`);
                arr.push(sel ? sel.value.trim() : '');
              });
              studentAns['q' + i] = arr;
            }

            // Câu 17-22 (text)
            for (let i = 17; i <= 22; i++) {
              const el = document.getElementById('input-q' + i);
              studentAns['q' + i] = el ? el.value.trim().replace(',', '.') : '';
            }

            // Tính điểm (giữ logic như bạn đã dùng)
            let totalScore = 0;
            for (let i = 1; i <= 22; i++) {
              const key = 'q' + i;
              const u = studentAns[key];
              const c = correctAnswers[key];

              if (i <= 12) {
                if (u && u === c) totalScore += 0.25;
              } else if (i >= 1 && i <= 16) {
                if (Array.isArray(u) && Array.isArray(c)) {
                  let correctCount = 0;
                  for (let j = 0; j < c.length; j++) if (u[j] === c[j]) correctCount++;
                  if (correctCount === 1) totalScore += 0.1;
                  else if (correctCount === 2) totalScore += 0.25;
                  else if (correctCount === 3) totalScore += 0.5;
                  else if (correctCount === 4) totalScore += 1;
                }
              } else {
                const userVal = parseFloat((u||'').toString().replace(',', '.'));
                const corVal = parseFloat((c||'').toString().replace(',', '.'));
                if (!isNaN(userVal) && !isNaN(corVal) && Math.abs(userVal - corVal) < 0.001) totalScore += 0.5;
              }
            }

            // Hiển thị điểm
            const scoreElement = document.getElementById("score-result");
            scoreElement.textContent = `Tổng điểm của bạn: ${totalScore.toFixed(2)} / 10`;
            scoreElement.className = (totalScore >= 5 ? 'correct' : 'incorrect');
            isScoreCalculated = true;

            // Lưu kết quả lên Firestore (gọi hàm module saveAttempt)
            const studentName = document.getElementById('student-name') ? document.getElementById('student-name').value.trim() : '';
            if (typeof saveAttempt === 'function') {
              try {
                saveAttempt('de2', studentAns, totalScore, studentName);
              } catch (err) {
                console.warn('Lưu kết quả thất bại (chưa đăng nhập?):', err);
              }
            }
          }
            
            </script>
   
    
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp, query, where, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";
// --- Firebase config ---
const firebaseConfig = {
  apiKey: "AIzaSyDDACFZgZazMOnjzmGM_lrKswVcsoTFHxA",
  authDomain: "veonline-3bcbf.firebaseapp.com",
  projectId: "veonline-3bcbf",
  storageBucket: "veonline-3bcbf.appspot.com",
  messagingSenderId: "83902304195",
  appId: "1:83902304195:web:2f9ec1ee0c23d6e21bb776"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ===== Toggle lời giải =====
window.toggleSolution = function(solutionId) {
  const solutionBox = document.getElementById(solutionId);
  if (!solutionBox) return alert(`Không tìm thấy box lời giải với ID: ${solutionId}`);
  const studentCode = localStorage.getItem("studentCode");
  if (studentCode) solutionBox.classList.toggle('visible');
  else document.getElementById('login-modal').classList.remove('hidden');
};

// ===== Form đăng nhập =====
const codeForm = document.getElementById('code-login-form');
if (codeForm) {
  codeForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const code = document.getElementById('login-code')?.value?.trim() || '';
    const nameInput = document.getElementById('student-name');
    const name = nameInput ? nameInput.value.trim() : '';

    console.log("🔹 Mã nhập:", code); // debug

    try {
      const codesRef = collection(db, "codes");
      const q = query(codesRef, where("code", "==", code));
      const querySnapshot = await getDocs(q);

      console.log("🔹 Số document tìm được:", querySnapshot.size);

      if (!querySnapshot.empty) {
        // Lấy document đầu tiên
        const docData = querySnapshot.docs[0].data();
        const studentNameFromDB = docData.name || name;

        localStorage.setItem("studentName", studentNameFromDB);
        localStorage.setItem("studentCode", code);

        document.getElementById('login-modal').classList.add('hidden');
        document.getElementById('auth-status').textContent = '✅ Đăng nhập thành công';
      } else {
        document.getElementById('auth-status').textContent = '❌ Mã không hợp lệ';
        document.getElementById('login-modal').classList.remove('hidden');
      }

    } catch (err) {
      console.error(err);
      document.getElementById('auth-status').textContent = '❌ Lỗi đăng nhập: ' + err.message;
    }
  });
}

// ===== Nút đăng nhập/đăng xuất =====
document.getElementById('login-button').addEventListener('click', (e) => {
  e.preventDefault();
  const studentCode = localStorage.getItem("studentCode");
  if (studentCode) {
    localStorage.removeItem("studentName");
    localStorage.removeItem("studentCode");
    document.getElementById('auth-status').textContent = 'Đã đăng xuất';
    document.querySelectorAll('.solution').forEach(el => el.classList.remove('visible'));
  } else {
    document.getElementById('login-modal').classList.remove('hidden');
  }
});

// ===== Đóng modal =====
document.getElementById('close-modal').addEventListener('click', () => {
  document.getElementById('login-modal').classList.add('hidden');
  document.getElementById('auth-status').textContent = '';
  document.getElementById('login-code').value = '';
});

// ===== Lưu kết quả bài làm =====
window.saveAttempt = async function(testId, answersObject, score) {
  const studentName = localStorage.getItem("studentName") || null;
  const studentCode = localStorage.getItem("studentCode") || null;
  if (!studentCode) return alert('⚠️ Vui lòng nhập mã trước khi lưu kết quả!');

  try {
    await addDoc(collection(db, 'attempts'), {
      name: studentName,
      code: studentCode,
      testId: testId || 'unknown',
      answers: answersObject || {},
      score: score,
      createdAt: serverTimestamp()
    });
    console.log('✅ Đã lưu bài làm');
  } catch (err) {
    console.error('❌ Lưu bài làm thất bại:', err);
  }
};



// ===== Check Answer (icon đúng/sai) =====
window.checkAnswer = function(questionId, correctAnswer) {
  const selected = document.querySelector(`input[name="${questionId}"]:checked`);
  const resultIcons = document.querySelectorAll(`#${questionId} .option-icon`);
  resultIcons.forEach(icon => icon.innerHTML = '');
  if (selected) {
    const icon = document.getElementById(`icon-${questionId}-${selected.value}`);
    icon.innerHTML = selected.value === correctAnswer ? '✔️' : '❌';
  }
};
 // Toggle hamburger menu
        $('.hamburger-btn').click(function(){
            $(this).toggleClass('active');
            $('#mainNav').toggleClass('active');
        });

        // Submenu
        $('.main-menu > li > a').click(function(e){
            if ($(window).width() <= 768) {
                var $submenu = $(this).siblings('.submenu');
                if ($submenu.length) {
                    e.preventDefault();
                    $submenu.toggleClass('active');
                    $(this).find('.dropdown-icon').toggleClass('active');
                }
            }
        });

        $('.submenu > li > a').click(function(e){
            if ($(window).width() <= 768) {
                var $nestedSubmenu = $(this).siblings('.nested-sub-menu');
                if ($nestedSubmenu.length) {
                    e.preventDefault();
                    $nestedSubmenu.toggleClass('active');
                    $(this).find('.nested-dropdown-icon').toggleClass('active');
                }
            }
        });
    
</script>



<!-- Floating button để toggle vẽ -->
<button class="floating-button" id="toggle-draw" aria-label="Bật/tắt chế độ vẽ">🖊️ Vẽ</button>
<!-- Canvas cho vẽ -->
<canvas id="drawCanvas"></canvas>

<!-- Toolbar công cụ vẽ -->
<div class="toolbar" id="drawToolbar" role="toolbar" aria-label="Thanh công cụ vẽ">
    <div class="drawing-tools">
        <select id="tool" title="Chọn công cụ" aria-label="Chọn công cụ vẽ">
            <option value="pen">✏️</option>
            <option value="line">📏</option>
            <option value="rect">⬛</option>
            <option value="circle">⚪</option>
            <option value="cube">📦</option>
            <option value="cone">🔺</option>
            <option value="cylinder">⬤</option>
            <option value="pyramid">🔻</option>
            <option value="sphere">⚽</option>
        </select>
        <button title="Undo" id="undo-canvas">↩️</button>
        <button title="Xóa" id="clear-canvas">🧹</button>
        <button title="Lưu" id="save-canvas">💾</button>
        <button title="Thoát" id="exit-draw">❌</button>
    </div>
    <input type="color" id="colorPicker" value="#ffffff" title="Chọn màu" aria-label="Chọn màu vẽ">
    <input type="range" id="draw-width" min="1" max="14" value="2" title="" aria-label="">
</div>
<!-- Nút toggle bảng xanh -->
<button class="blackboard-toggle" id="toggle-blackboard" aria-label="Bật/tắt bảng xanh">📋</button>

<!-- Bảng xanh -->
<div id="blackboard" class="blackboard" role="region" aria-label="Bảng xanh">
    <button id="close-blackboard" aria-label="Đóng bảng xanh">❌</button>
</div>

<!-- Scripts -->
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js"></script>
<script>
MathJax = {
    tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], processEscapes: true },
    chtml: { linebreaks: { automatic: true } }
};
</script>


<script>
// Script vẽ canvas (giữ nguyên từ trước, với #drawCanvas trong suốt)
// Firebase code (giữ nguyên, không đụng đến)

        document.addEventListener('DOMContentLoaded', () => {
            // Kiểm tra tồn tại các phần tử DOM
            const canvas = document.getElementById('drawCanvas');
            const toolbar = document.getElementById('drawToolbar');
            const toggleBtn = document.getElementById('toggle-draw');
            const undoBtn = document.getElementById('undo-canvas');
            const clearBtn = document.getElementById('clear-canvas');
            const saveBtn = document.getElementById('save-canvas');
            const exitBtn = document.getElementById('exit-draw');
            const colorPicker = document.getElementById('colorPicker');
            const toolSelect = document.getElementById('tool');
            const widthPicker = document.getElementById('draw-width');

            if (!canvas || !toolbar || !toggleBtn || !undoBtn || !clearBtn || !saveBtn || !exitBtn || !colorPicker || !toolSelect || !widthPicker) {
                console.error('Một hoặc nhiều phần tử DOM không tìm thấy. Kiểm tra ID trong HTML.');
                return;
            }

            const ctx = canvas.getContext('2d');
            let lineWidth = parseInt(widthPicker.value) || 2;
            let isDrawing = false;
            let isDrawMode = false;
            let startX = 0, startY = 0;
            let currentTool = toolSelect.value || 'pen';
            let imageBeforeShape;
            const history = []; // Lưu lịch sử vẽ
            const maxHistory = 50; // Giới hạn lịch sử để tránh tràn bộ nhớ

            // Resize canvas
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                if (history.length > 0) {
                    ctx.putImageData(history[history.length - 1], 0, 0); // Vẽ lại từ lịch sử
                }
            }
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);

            // Toggle vẽ mode với animation
            function toggleDrawMode() {
                isDrawMode = !isDrawMode;
                canvas.style.display = isDrawMode ? 'block' : 'none';
                toolbar.style.transition = 'opacity 0.3s, transform 0.3s';
                toolbar.style.opacity = isDrawMode ? '1' : '0';
                toolbar.style.transform = isDrawMode ? 'translateY(0)' : 'translateY(20px)';
                toolbar.style.display = isDrawMode ? 'flex' : 'none';
                toggleBtn.textContent = isDrawMode ? '❌ Tắt vẽ' : '🖊️ Vẽ';
            }

            toggleBtn.addEventListener('click', toggleDrawMode);
            exitBtn.addEventListener('click', toggleDrawMode);

            // Chọn công cụ
            toolSelect.addEventListener('change', () => {
                currentTool = toolSelect.value;
            });

            // Cập nhật màu và độ dày
            colorPicker.addEventListener('input', () => ctx.strokeStyle = colorPicker.value);
            widthPicker.addEventListener('input', () => {
                lineWidth = parseInt(widthPicker.value) || 2;
            });

            // Undo
            undoBtn.addEventListener('click', () => {
                history.pop(); // Xóa bước cuối
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                if (history.length > 0) {
                    ctx.putImageData(history[history.length - 1], 0, 0);
                }
            });

            // Xóa canvas
            clearBtn.addEventListener('click', () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                history.length = 0; // Xóa lịch sử
            });

            // Lưu canvas
            saveBtn.addEventListener('click', () => {
                try {
                    const link = document.createElement('a');
                    link.download = 'ban_ve.png';
                    link.href = canvas.toDataURL('image/png');
                    link.click();
                } catch (error) {
                    console.error('Lỗi khi lưu canvas:', error);
                }
            });

            // Lấy vị trí chuột/cảm ứng
            function getPos(e) {
                if (e.touches && e.touches.length > 0) {
                    return { x: e.touches[0].clientX, y: e.touches[0].clientY };
                }
                return { x: e.clientX, y: e.clientY };
            }

            // Bắt đầu vẽ
            function startDraw(e) {
                if (!isDrawMode) return;
                e.preventDefault();
                const pos = getPos(e);
                isDrawing = true;
                startX = pos.x;
                startY = pos.y;
                if (currentTool !== 'pen') {
                    imageBeforeShape = ctx.getImageData(0, 0, canvas.width, canvas.height);
                } else {
                    ctx.beginPath();
                    ctx.moveTo(startX, startY);
                }
            }

            // Vẽ
            function drawMove(e) {
                if (!isDrawing || !isDrawMode) return;
                e.preventDefault();
                const pos = getPos(e);
                ctx.strokeStyle = colorPicker.value;
                ctx.lineWidth = lineWidth;
                ctx.lineCap = 'round';

                if (currentTool === 'pen') {
                    ctx.lineTo(pos.x, pos.y);
                    ctx.stroke();
                } else {
                    ctx.putImageData(imageBeforeShape, 0, 0);
                    if (currentTool === 'line') {
                        ctx.beginPath();
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(pos.x, pos.y);
                        ctx.stroke();
                    } else if (currentTool === 'rect') {
                        ctx.strokeRect(startX, startY, pos.x - startX, pos.y - startY);
                    } else if (currentTool === 'circle') {
                        const radius = Math.hypot(pos.x - startX, pos.y - startY);
                        ctx.beginPath();
                        ctx.arc(startX, startY, radius, 0, Math.PI * 2);
                        ctx.stroke();
                    } else if (currentTool === 'cube') {
                        let size = Math.min(Math.abs(pos.x - startX), Math.abs(pos.y - startY));
                        ctx.strokeRect(startX, startY, size, size);
                        ctx.strokeRect(startX + 10, startY - 10, size, size);
                        ctx.beginPath();
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(startX + 10, startY - 10);
                        ctx.moveTo(startX + size, startY);
                        ctx.lineTo(startX + size + 10, startY - 10);
                        ctx.moveTo(startX, startY + size);
                        ctx.lineTo(startX + 10, startY + size - 10);
                        ctx.moveTo(startX + size, startY + size);
                        ctx.lineTo(startX + size + 10, startY + size - 10);
                        ctx.stroke();
                    } else if (currentTool === 'cone') {
                        let radius = Math.abs(pos.x - startX);
                        ctx.beginPath();
                        ctx.ellipse(startX, startY + 40, radius, 10, 0, 0, Math.PI * 2);
                        ctx.moveTo(startX - radius, startY + 40);
                        ctx.lineTo(startX, startY - 40);
                        ctx.lineTo(startX + radius, startY + 40);
                        ctx.stroke();
                    } else if (currentTool === 'cylinder') {
                        let r = Math.abs(pos.x - startX);
                        ctx.beginPath();
                        ctx.ellipse(startX, startY, r, 10, 0, 0, Math.PI * 2);
                        ctx.moveTo(startX - r, startY);
                        ctx.lineTo(startX - r, startY + 100);
                        ctx.moveTo(startX + r, startY);
                        ctx.lineTo(startX + r, startY + 100);
                        ctx.ellipse(startX, startY + 100, r, 10, 0, 0, Math.PI);
                        ctx.stroke();
                    } else if (currentTool === 'pyramid') {
                        ctx.beginPath();
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(startX + 60, startY);
                        ctx.lineTo(startX + 30, startY + 60);
                        ctx.closePath();
                        ctx.moveTo(startX + 30, startY + 60);
                        ctx.lineTo(startX + 30, startY - 40);
                        ctx.stroke();
                    } else if (currentTool === 'sphere') {
                        let r = Math.abs(pos.x - startX);
                        ctx.beginPath();
                        ctx.arc(startX, startY, r, 0, Math.PI * 2);
                        ctx.ellipse(startX, startY, r, r / 2, 0, 0, Math.PI * 2);
                        ctx.stroke();
                    }
                }
            }

            // Kết thúc vẽ
            function endDraw() {
                if (!isDrawMode) return;
                isDrawing = false;
                if (history.length >= maxHistory) history.shift(); // Giới hạn lịch sử
                history.push(ctx.getImageData(0, 0, canvas.width, canvas.height)); // Lưu vào lịch sử
            }

            // Thêm sự kiện
            canvas.addEventListener('mousedown', startDraw);
            canvas.addEventListener('mousemove', drawMove);
            canvas.addEventListener('mouseup', endDraw);
            canvas.addEventListener('touchstart', startDraw, { passive: false });
            canvas.addEventListener('touchmove', drawMove, { passive: false });
            canvas.addEventListener('touchend', endDraw);
        });
        
</script>
<script>
// Script bảng xanh
document.addEventListener('DOMContentLoaded', () => {
    const toggleBlackboard = document.getElementById('toggle-blackboard');
    const blackboard = document.getElementById('blackboard');
    const closeBlackboard = document.getElementById('close-blackboard');
    const toggleDraw = document.getElementById('toggle-draw');

    if (!toggleBlackboard || !blackboard || !closeBlackboard || !toggleDraw) {
        console.error('DOM missing: toggle-blackboard, blackboard, close-blackboard, toggle-draw');
        return;
    }

    let isBlackboardMode = false;
    let isDraggingBoard = false;
    let dragStartX = 0, dragStartY = 0;

    function toggleBlackboardMode() {
        isBlackboardMode = !isBlackboardMode;
        blackboard.classList.toggle('show', isBlackboardMode);
        blackboard.style.display = isBlackboardMode ? 'block' : 'none';
        toggleBlackboard.classList.toggle('active', isBlackboardMode);
        if (isBlackboardMode) toggleDraw.click(); // Tự động bật canvas vẽ
        console.log('Toggle blackboard:', isBlackboardMode);
    }

    toggleBlackboard.addEventListener('click', (e) => {
        e.stopPropagation();
        toggleBlackboardMode();
    });

    closeBlackboard.addEventListener('click', toggleBlackboardMode);

    blackboard.addEventListener('mousedown', (e) => {
        if (e.target === closeBlackboard) return;
        isDraggingBoard = true;
        dragStartX = e.clientX - blackboard.offsetLeft;
        dragStartY = e.clientY - blackboard.offsetTop;
        e.preventDefault();
    });

    document.addEventListener('mousemove', (e) => {
        if (isDraggingBoard) {
            blackboard.style.left = `${e.clientX - dragStartX}px`;
            blackboard.style.top = `${e.clientY - dragStartY}px`;
            blackboard.style.transform = 'none';
        }
    });

    document.addEventListener('mouseup', () => {
        isDraggingBoard = false;
    });

    blackboard.addEventListener('touchstart', (e) => {
        if (e.target === closeBlackboard) return;
        const touch = e.touches[0];
        isDraggingBoard = true;
        dragStartX = touch.clientX - blackboard.offsetLeft;
        dragStartY = touch.clientY - blackboard.offsetTop;
        e.preventDefault();
    }, { passive: false });

    document.addEventListener('touchmove', (e) => {
        if (isDraggingBoard) {
            const touch = e.touches[0];
            blackboard.style.left = `${touch.clientX - dragStartX}px`;
            blackboard.style.top = `${touch.clientY - dragStartY}px`;
            blackboard.style.transform = 'none';
            e.preventDefault();
        }
    }, { passive: false });

    document.addEventListener('touchend', () => {
        isDraggingBoard = false;
    });
});
</script>
<script>
  localStorage.removeItem("studentCode");
</script>


</body>
</html>
